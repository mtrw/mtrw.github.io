<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Getting started with R for statistics and bioinformatics</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CropGEM Bioinformatics Hub</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="./getting_started.html">Getting Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    University Computing Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://dashboard.hpc.unimelb.edu.au/started/">UoM Spartan Dashboard (Linux cluster for bioinformatics)</a>
    </li>
    <li>
      <a href="https://dashboard.hpc.unimelb.edu.au/karaage/">UoM Karaage (cluster account management)</a>
    </li>
    <li>
      <a href="https://spartan-ood.hpc.unimelb.edu.au/pun/sys/dashboard/batch_connect/sys/RStudio/session_contexts/new">UoM OnDemand Dashboard (R)</a>
    </li>
    <li>
      <a href="https://rcp.research.unimelb.edu.au/home/">UoM Research Computing Portal Dashboard (VM)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Software Downloads
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://www.putty.org/">PuTTy (SSH connection to Spartan)</a>
    </li>
    <li>
      <a href="https://www.nsoftware.com/sftp/drive/download.aspx">SFTP Drive (Access project storage from your desktop or a VM (Windows))</a>
    </li>
  </ul>
</li>
<li>
  <a href="./tutorials.html">Tutorials</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Useful Links
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Format Specifications</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="https://samtools.github.io/hts-specs/VCFv4.3.pdf">VCF/BCF</a>
        </li>
        <li>
          <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">SAM/BAM</a>
        </li>
        <li>
          <a href="https://asia.ensembl.org/info/website/upload/gff3.html">GFF3</a>
        </li>
        <li>
          <a href="https://asia.ensembl.org/info/website/upload/bed.html">BED</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Cheatsheets</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="https://defkey.com/putty-shortcuts">PuTTy</a>
        </li>
        <li>
          <a href="https://remram44.github.io/regex-cheatsheet/regex.html">REGEX</a>
        </li>
        <li>
          <a href="https://www.metagenomics.wiki/tools/blast/blastn-output-format-6">BLASTn output formatting</a>
        </li>
        <li>
          <a href="https://aperiodic.net/screen/quick_reference">GNU screen</a>
        </li>
        <li>
          <a href="https://devhints.io/vim">Vim</a>
        </li>
        <li>
          <a href="https://www.bash2zsh.com/zsh_refcard/refcard.pdf">Zsh</a>
        </li>
        <li>
          <a href="https://www.samformat.info/sam-format-flag">SAM format flag widget</a>
        </li>
        <li>
          <a href="https://ss64.com/bash/chmod.html">chmod flag widget</a>
        </li>
        <li>
          <a href="https://devhints.io/makefile">make</a>
        </li>
        <li>
          <a href="https://marklodato.github.io/visual-git-guide/index-en.html">git</a>
        </li>
        <li>
          <a href="https://www.samformat.info/sam-format-flag">SAM format flag widget</a>
        </li>
        <li class="dropdown-submenu">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">R</a>
          <ul class="dropdown-menu" role="menu">
            <li>
              <a href="https://github.com/mtrw/tim_r_functions">Tim's functions (github)</a>
            </li>
            <li>
              <a href="https://raw.githubusercontent.com/mtrw/tim_r_functions/master/tim_functions.R">Tim's functions (raw code to `source()`)</a>
            </li>
            <li>
              <a href="https://s3.amazonaws.com/assets.datacamp.com/img/blog/data+table+cheat+sheet.pdf">data.table</a>
            </li>
            <li>
              <a href="https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-visualization-2.1.pdf">ggplot2 (not cool)</a>
            </li>
            <li>
              <a href="https://r-graph-gallery.com/134-general-plot-parameters-reminder">base::plot (cool) plot parameters</a>
            </li>
            <li>
              <a href="https://r-graph-gallery.com/6-graph-parameters-reminder.html">base::plot (cool) point parameters</a>
            </li>
            <li>
              <a href="https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf">Rmarkdown</a>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Manuals/Documentation</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="https://dashboard.hpc.unimelb.edu.au/started/">Spartan HPC Documentation</a>
        </li>
        <li>
          <a href="https://slurm.schedmd.com/sbatch.html">Slurm Sbatch</a>
        </li>
        <li>
          <a href="https://wiki-rcs.unimelb.edu.au/display/RCS/Mediaflux">MediaFlux</a>
        </li>
        <li>
          <a href="https://man7.org/linux/man-pages/man1/sftp.1.html">Linux SFTP</a>
        </li>
        <li>
          <a href="https://www.ncbi.nlm.nih.gov/books/NBK279690/pdf/Bookshelf_NBK279690.pdf">BLAST</a>
        </li>
        <li>
          <a href="https://www.gnu.org/software/gawk/manual/gawk.html">AWK</a>
        </li>
        <li>
          <a href="https://www.bx.psu.edu/~rsharris/lastz/">Lastz</a>
        </li>
        <li>
          <a href="https://evolution.genetics.washington.edu/phylip/phylip.html">PHYLIP</a>
        </li>
        <li>
          <a href="https://adv-r.hadley.nz/">Advanced R</a>
        </li>
        <li>
          <a href="https://bedtools.readthedocs.io/en/latest/index.html">Bedtools</a>
        </li>
        <li>
          <a href="https://zsh-manual.netlify.app/the-z-shell-manual">Zsh</a>
        </li>
        <li>
          <a href="https://zsh.sourceforge.io/Intro/intro_1.html">Zsh -- introductory manual</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mtrw">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Getting started with R for statistics and
bioinformatics</h1>

</div>


<hr />
<div id="background" class="section level1">
<h1>Background</h1>
<div id="what-is-r" class="section level3">
<h3>What is <code>R</code>?</h3>
<p>R is a <em>programming language</em>–a way for a human to tell a
computer to do things–designed specifically for analysing data, doing
statistics, and creating graphics. It is extremely popular, and
extremely useful. Users of R can create <em>packages</em>, which add new
functions to R, and thanks to the existence of several thousand
publicly-available packages, R has an incredibly large range of
applications. In the field of bioinformatics, R’s only main competitor
is the language Python, and knowing at least one of these is essential
to working as a bioinformatician.</p>
</div>
<div id="what-makes-this-tutorial-different" class="section level3">
<h3>What makes this tutorial different</h3>
<p>There are plenty of R tutorials out there, and even some specific to
bioinformatics. Subtly, each reflects the preferences and styles of the
writer. You will eventually develop your own style, but your starting
point will greatly affect how fast you converge on a style that is
optimal for the work you’re doing while reflecting your personality. And
yes, coding is a very expressive, creative activity and (in my opinion)
just as much a means of self-expression as painting or writing
music.</p>
<p>This tutorial favours a style that:</p>
<ul>
<li>Is <strong>best for bioinformatics</strong>, where SPEED is hugely
important.</li>
<li>Encourages understanding of all the code at a deep level. This:
<ul>
<li><strong>Promotes creativity</strong>, by encouraging understanding
of all the code at a deep level, meaning you are free to express any
idea that comes into your head. ‘Black boxes’ are avoided.</li>
</ul></li>
</ul>
<p>Because it aims to give you a deeper understanding, it spends a while
on the fundamentals. Much of what you learn in Part 1, you will not use
in everyday code because there are simpler ways to do it using more
sophisticated tools. BUT, as soon as you want to do something
<em>special</em>, or <em>creative</em>, or exceptionally
<em>efficient</em>, or <em>new</em>, you will need to understand the
fundamentals. Similarly, knowing your fundamentals means you become far
better at using more advanced tools. Errors become less mysterious,
results make more sense, customising the tools becomes possible. This
tutorial assumes you want to truly learn the R language, not just use it
to get one task done.</p>
<p>That said, the tutorial does not waste your time forcing you to learn
every single tiny feature and function in R. It focuses on examples to
help you get the key <strong>concepts</strong>. The best way to find and
understand specific features you want to use in your work is to find
code written by more experienced people who have done a task similar to
yours before, and learn from it—but once you’ve finished these
tutorials, the code you read from other people and from internet
searches will make much more sense and be much faster to absorb and
modify.</p>
</div>
<div
id="dazzling-data.table-and-the-tidyverse-tyranny-do-decide-to-to-dump-dplyr."
class="section level3">
<h3>Dazzling data.table and the tidyverse tyranny (do decide to to dump
dplyr).</h3>
<p>R’s basic functionality can be expanded using <em>packages</em>–think
of plugins for browsers or apps for a phone. Some packages fundamentally
change the way you write R code. The developers of R and R studio have
developed a collection of packages known as the <em>tidyverse</em>
packages. They are immensely popular, partly because they are easy to
use, and partly because the developers of R and Rstudio have a natural
advantage in ‘influencing’ (or … monopolising?) the way people code.</p>
<p>Unfortunately, the tidyverse way of coding is neither the optimal for
bioinformatics, nor is it the best for creativity.</p>
<p>The package <code>data.table</code> is a far better option. Compared
to tidyverse methods, it is much faster, saves memory, and most
importantly you can describe extremely creative and complex ideas in a
very simple way. It takes a tiny bit longer to learn the basics–maybe
two full days compared with one full day. But it is worth it. There is a
special tutorial on data.table waiting for you once you finish this one,
<a href="tutorial_data_table.Rmd">here</a>.</p>
</div>
<div id="how-to-do-this-tutorial" class="section level3">
<h3>How to do this tutorial</h3>
<ol style="list-style-type: decimal">
<li>Don’t just read. Write and run all the commands yourself. If you
miss one, others later may not run. Most importantly, <em>play with the
commands</em>. Change things around, try new things, connect ideas
together, try to break the commands, then figure out why (<a
href="www.duckduckgo.com">searching the web</a> might help).</li>
<li>This is about learning the fundamentals. Don’t load any packages. Do
<strong>NOT</strong> under any circumstances load <code>dplyr</code>, do
<strong>NOT</strong> use <code>select</code>, <code>filter</code>,
<code>arrange</code>, <code>mutate</code>, or any of those silly
things.</li>
<li>If you get stuck or you want to dig into a topic for greater
understanding, first try R’s inbuilt help functions (see below). Web
searches can also be great, but be aware the answers vary a lot in
quality. There is also …</li>
<li>ChatGPT, which needs a short discussion …
<ul>
<li><strong>Don’t</strong> <em>use chatGPT to write code for you</em>,
especially while you are learning. It generally produces awful code. In
particular, it has been trained on code it finds on the internet, and it
cannot distinguish good code from bad code. Since most code on the
internet is bad, that is what it produces. It relies excessively on
loading obscure packages to perform tasks that can easily and quickly be
done with standard functions, it wantonly and wastefully converts data
between different formats, makes inefficient choices, and worst of all,
it makes it very tempting to run code you don’t actually understand and
couldn’t write yourself.</li>
<li><strong>Do</strong> <em>use chatGPT to read the manual for you</em>.
Once you already know some R, use chatGPT to remind yourself of bits you
can’t remember or haven’t discovered yet. You will find yourself
thinking “I’m sure there is a function to do this, but I don’t know what
it is!” That’s a great time to ask chatGPT for help. Ask it for example:
<ul>
<li>“What are the parameters that control the size and type of points in
a scatterplot in base R?”</li>
<li>“How can I check whether a file exists in R?”</li>
</ul></li>
<li><strong>Do</strong> <em>use chatGPT to explain functions or code to
you</em>. Excellent uses of chatGPT are questions like
<ul>
<li>“Please break down this line of R code: ‘m %&lt;&gt;% apply( 1 ,
function(x){x/sum(x)} )’”</li>
<li>“In the R code ‘frank(x,ties.method=’dense’)‘, what does the ’dense’
argument mean?”</li>
</ul></li>
</ul></li>
</ol>
<blockquote>
<p>A good rule-of-thumb is that chatGPT is something you show code
<em>to</em>, not something you get code <em>from</em>, especially not
whole lines or multiple lines of code.</p>
</blockquote>
<hr />
</div>
</div>
<div id="part-1-r-fundamentals" class="section level1">
<h1>Part 1: R fundamentals</h1>
<hr />
<div id="starting-an-r-session-on-spartan" class="section level2">
<h2>Starting an R session on Spartan</h2>
<p>If you haven’t already, start an R session by following <a
href="tutorial_Rstart.html">these</a> instructions.</p>
<hr />
</div>
<div id="creating-and-running-commands-in-your-first-r-script"
class="section level2">
<h2>Creating and running commands in your first R script</h2>
<p>You will start with a screen like this …</p>
<p><img src="images/RstudioScreen.png" /></p>
<p>First thing, create a new <em>script</em> using this button. A script
is just a text file you use to save R <em>commands</em> that achieve
some task. Use <code>&lt;ctrl&gt; + s</code> so save, and name it, say,
<em>tutorial.R</em>.</p>
<p><img src="images/Rscript.png" /></p>
<p>To test things are working, type the following into the script:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">print</span>(a)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">plot</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>Each of these lines is a command. Let’s run the first command.
Highlight the command using the mouse, then run it using
<code>&lt;ctrl&gt; + &lt;return&gt;</code> (aka
<code>&lt;ctrl&gt; + &lt;enter&gt;</code>).</p>
<p>You should see this:</p>
<p><img src="images/RfirstRun.png" /></p>
<p>Notice:</p>
<ul>
<li>The command appears in the lower left window. This is known as the
<em>R console</em>. It is analagous to the linux command line, except
running R. It is both where commands are inputted, and where much of
their results are outputted. You can always type commands directly into
the console, but the trick using
<code>&lt;ctrl&gt; + &lt;return&gt;</code> is a far more convenient way
to work.</li>
<li>In the top right under the ‘Environment’ tab, the value “a” is
recorded. This will make more sense later.</li>
<li>In the lower right under the ‘Files’ tab, we can see the contents of
our home directory, including our script. This is simply a file browser,
and is immensely useful.</li>
</ul>
<p>Now run the second command a different way. Instead of highlighting
the command, simply place the cursor on the same line, and hit
<code>&lt;ctrl&gt; + &lt;return&gt;</code>. Notice it sends the whole
line to the console. This is the most common way to run commands. We use
the highlighting trick when we want to run just small parts of larger
commands.</p>
<p>Notice:</p>
<ul>
<li>The console now contains the command, and also some <em>output</em>,
the numbers 1–10, probably in a different colour to the command. this is
the result of the command we sent it.</li>
</ul>
<p>Run the last command, which creates a plot. If it works ok, you will
see a plot appear in the lower right window, which will automatically
switch to the ‘Plots’ tab.</p>
<p><img src="images/RplotFirst.png" /></p>
<p>Look for the button labelled “Export”. This is one way to save plots
you create as images or vector graphics. Try it if you want.</p>
<hr />
</div>
<div id="basic-operations-and-operator-precendence"
class="section level2">
<h2>Basic operations and operator precendence</h2>
<p>Some of the most simple commands in R perform basic maths. Play
around with running these.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">3</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="dv">8</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fl">88398.7493</span> <span class="sc">-</span> <span class="dv">72992</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fl">1.3e5</span> <span class="sc">+</span> <span class="dv">1</span></span></code></pre></div>
<p>Notice the last one uses scientific notation.</p>
<p>Try to guess the output of this before you run it:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="dv">3</span><span class="sc">+</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span></span></code></pre></div>
<p>Notice it did the division first, which is conventional according to
BEDMAS. In programming talk, we say the division operator
(<code>/</code>) has higher <em>precedence</em> than the addition
operator (<code>+</code>).</p>
<p>We can control the order of operations using brackets:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="dv">3</span><span class="sc">+</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>(<span class="dv">3</span><span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>((<span class="dv">3</span><span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>((<span class="dv">3</span><span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">10</span>)<span class="sc">**</span><span class="dv">2</span></span></code></pre></div>
<p>The double asterisk (**) does exponentiation (raising to a power).
The carat symbol (^) also works.</p>
<hr />
</div>
<div id="comments" class="section level2">
<h2>Comments</h2>
<p>Any command that begins with a hash (<code>#</code>) will not be run.
These are known as <em>code comments</em> and are what you use to
include helpful notes in your script. They are immensely important when
writing good code. They can also be very funny. The most famous code
comment ever written is “/* You are not expected to understand this */”
which was <a
href="https://thenewstack.io/not-expected-understand-explainer/?utm_referrer=https%3A%2F%2Fwww.linux.com%2F">part
of the UNIX operating system</a>.</p>
<p>If the hash occurs within a line, everything to the right will not
run.</p>
<hr />
</div>
<div id="variables-vectors-and-vectorised-functions"
class="section level2">
<h2>Variables, vectors, and vectorised functions</h2>
<p>What did the command <code>a &lt;- 1:10</code> do? We can find out
with some experimentation. Highlight only the <code>1:10</code> part of
the command and have a look at the output:</p>
<p>What did our previous command do? Try highlighting only the
<code>1:10</code> part and running that with
<code>&lt;ctrl&gt; + &lt;return&gt;</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="co"># produces 1, 2, 3, ... , 10</span></span></code></pre></div>
<p>Great! We have a “list” of numbers from 1 to 10. Such lists of things
are called <em>vectors</em> and are fundamental to R. The colon
(<code>:</code>) is a shortcut for creating vectors of concurrent
integers.</p>
<p><strong>Exercises:</strong></p>
<ul>
<li>Try using the colon operator to create a vector numbers from 201 to
1002.</li>
<li>Then try making a list of numbers that goes backwards, starting on a
positive number, and ending on a negative number.</li>
</ul>
<details>
<summary>
<strong>See answers:</strong>
</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="dv">201</span><span class="sc">:</span><span class="dv">1002</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="dv">6</span><span class="sc">:-</span><span class="dv">2</span></span></code></pre></div>
<p>Answer</p>
</details>
<hr />
</div>
<div id="variable-assignment-and-printing" class="section level2">
<h2>Variable assignment and printing</h2>
<p>The command we ran, though, had two more components: <code>a</code>
and <code>&lt;-</code>.</p>
<p>The symbol <code>a</code> here is a user-chosen name given to a
<em>variable</em>, a kind of “box” that holds particular values (in this
case, the vector of integers 1 to 10), and referred to by the label
<code>a</code>. The <code>&lt;-</code> symbol takes whatever is produced
by the code on its right, and stores it in the box labelled whatever is
on the left.</p>
<p>The variable name can them be used in code to provide the value it
contains. Play around with that idea until it feels comfortable,
e.g. …</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>a <span class="co"># Running a variable name by itself outputs the contents in the console</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>a <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>a <span class="sc">+</span> a</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>a <span class="sc">+</span> b</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>c <span class="ot">&lt;-</span> a <span class="sc">/</span> b</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>c <span class="sc">*</span> <span class="dv">7</span></span></code></pre></div>
<p><strong>Exercises:</strong></p>
<ul>
<li>Guess a way to assign the value 2 to <em>two</em> variables named
‘a’ and ‘b’ using just one line of code …</li>
</ul>
<details>
<summary>
<strong>See answer:</strong>
</summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>a <span class="co"># prints 2</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>b <span class="co"># ... same</span></span></code></pre></div>
</details>
<ul>
<li>In the above example, if you change the value of ‘a’, will that
affect the value of ‘b’? To find out, try increasing the value of ‘a’ by
1. Do it in such a way that it would work no matter what value ‘a’
contains.</li>
</ul>
<details>
<summary>
<strong>See answer:</strong>
</summary>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> a <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>a <span class="co"># prints 3</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>b <span class="co"># prints 2. No!--changing b does not affect a.</span></span></code></pre></div>
</details>
<hr />
</div>
<div id="vectorised-operations" class="section level2">
<h2>Vectorised operations</h2>
<p>Now we have seen a few operations like <code>+</code>,
<code>*</code>, etc. working on numbers, and we know how to create a
vector using <code>1:10</code> containing the numbers 1, 2, 3, …, 10, we
may well ask what happens when we do these operations on a vector.</p>
<p><strong>Exercise: (using numeric vectors
e.g. <code>1:10</code>)</strong></p>
<ul>
<li>Work out what happens when you add a single number to a vector of
length 10.</li>
<li>Try the same with the operands swapped. Is the result the same?</li>
<li>Work out what happens when you add a vector of length 10 to
itself.</li>
<li>Create two vectors of length 10, and divide one by the other.
<ul>
<li>Try including a zero in the denominator vector. What happens when
you try to divide by zero?</li>
</ul></li>
<li>Subtract a vector of length 10 from a vector if length 3. What
happens?</li>
<li>Subtract a vector of length 10 from a vector if length 2. What
happens?
<ul>
<li>Try this with the operands reversed. What happens?</li>
</ul></li>
</ul>
<details>
<summary>
<strong>See answer:</strong>
</summary>
<p>Here are some examples of commands that fit the exercise, and the
answers as comments:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">+</span> <span class="dv">5</span> <span class="co"># The single value is added to each element of the vector</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="co"># Same result</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>v <span class="sc">+</span> v <span class="co"># Each element in the left hand operand is added to the corresponding element in the right hand operand.</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>v<span class="sc">/</span>w <span class="co"># As above. The results are decimals.</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>v<span class="sc">/</span>w <span class="co"># When dividing by zero, we get the special value &#39;Inf&#39; meaning &#39;infinite&#39;.</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>v<span class="sc">-</span>x <span class="co"># Error! &quot;In v/x : longer object length is not a multiple of shorter object length&quot;</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>v<span class="sc">-</span>y <span class="co"># Interesting. We get `0 0 2 2 4 4 6 6 8 8`. Discussed below.</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>y<span class="sc">-</span>v <span class="co"># We get `0  0 -2 -2 -4 -4 -6 -6 -8 -8`.</span></span></code></pre></div>
</details>
<p>So, if we think about those results a bit we an arrive at a few
general rules:</p>
<ol style="list-style-type: decimal">
<li>The results are given by ‘lining up’ the vectors and running the
operation on each pair of <em>elements</em> (or “members” of a
vector):</li>
</ol>
<pre><code>Command:
---------
1:4 + 5:2
---------


Calculations:
-------
1 2 3 4
+ + + +
5 4 3 2
-------

Result:
-------
6 6 6 6
-------</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>If one vector ‘runs out’ of elements, it is repeated (or as it is
known, <em>recycled</em>):</li>
</ol>
<pre><code>Command:
---------
1:4 + 2:3
---------


Calculations:
-------
1 2 3 4
+ + + +
2 3 2 3
-------

Result:
-------
3 5 5 7
-------</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>The length of the shorter vector must divide into the length of the
longer one.</li>
</ol>
<p><em>Vectorised</em> operations–operations that work on vectors
following these rules–are really at the heart of R, and are the main
reason it is so powerful as a statistical language.</p>
<p>All these rules extend naturally to operations on more than two
vectors.</p>
<p><strong>Exercise:</strong></p>
<ul>
<li>Use what you know about <strong>vectorised operations</strong> and
<strong>precendence</strong> to carefully predict what these functions
will do before you run them. Note that <code>*</code> has precendence
over <code>+</code>.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">*</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span></code></pre></div>
<ul>
<li>Add brackets to one or both commands to make them both work.</li>
</ul>
<summary>
<strong>Get help with the answer:</strong>
</summary>
<details>
Try running sub-parts of each command separately,
e.g. <code>1:4 * 1:6</code> and <code>1:6 + 1:12</code>. Ask yourself
which will be run first, given the precendence rules. Note the length of
the outputs, and think about how they will be recycled in the context of
the whole command.
</details>
<hr />
</div>
<div id="vector-classes" class="section level2">
<h2>Vector classes</h2>
<p>Different kinds of data or information needs to be stored in
different ways. A list of SNP positions is a collection of integer
numbers, while a list of plant heights in centimetres will be a decimal
number. A list of sample ID codes is probably strings of text, while
data on whether a plant belongs to the control group might suit a
TRUE/FALSE format. R has different kinds (or <em>classes</em>) of
vectors to cover all these cases.</p>
<p>Later, we will learn how these can be connected together into tables,
a bit like spreadsheets. But first we need to master the basics of the
different types of vector and how to work with them.</p>
<div id="integer-numeric" class="section level3">
<h3>Integer &amp; numeric</h3>
<p>We have already worked with vectors containing integers (-1, 0, 1, 2,
3, …) so far, and we have seen that vectors with decimals can also
exist.</p>
<p>These two types of vector <em>classes</em>—<em>integer</em> and
<em>numeric</em>—are actually different. Behind the scenes, it takes
more memory to store decimal numbers, and performing operations on them
takes more calculations (more info for the perplexed (here)[<a
href="https://matloka.com/blog/floating-point-101"
class="uri">https://matloka.com/blog/floating-point-101</a>]). But they
can store not only decimals, but far larger numbers than integer vectors
can. By default, R assumes we are happy with integers wherever possible,
and will silently convert vectors to numeric types when necessary.</p>
</div>
<div id="character" class="section level3">
<h3>Character</h3>
<p>We haven’t yet seen character vectors. R actually loads a variable
containing a character vector automatically when it starts, the variable
<code>letters</code>. This is what it contains.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>letters</span></code></pre></div>
<pre><code>##  [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; &quot;j&quot; &quot;k&quot; &quot;l&quot; &quot;m&quot; &quot;n&quot; &quot;o&quot; &quot;p&quot; &quot;q&quot; &quot;r&quot; &quot;s&quot;
## [20] &quot;t&quot; &quot;u&quot; &quot;v&quot; &quot;w&quot; &quot;x&quot; &quot;y&quot; &quot;z&quot;</code></pre>
<p>Not surprising. Notice all the entries are in quote marks
(<code>"..."</code>), which tells R you are dealing with character
types. Consider the following to see why that’s important:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> a</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="st">&quot;a&quot;</span></span></code></pre></div>
<p>Here, <code>b</code> contains 3, which is an integer that was copied
from the <em>variable</em> <code>a</code>. But <code>c</code> contains
the <em>character</em> “a”, which R knew because we put it in quote
marks.</p>
</div>
<div id="logical" class="section level3">
<h3>Logical</h3>
<p>One of the most important vector types stores the values
<code>TRUE</code> or <code>FALSE</code> (or <code>NA</code>). They are
truly fundamental in R and we will see more of this in the section on
logical operations.</p>
<hr />
</div>
</div>
<div id="special-values-including-na" class="section level2">
<h2>Special values including ‘NA’</h2>
<p>As we saw when dividing by zero, some calculations don’t result in a
‘normal’ value, and R accommodates this.</p>
<p>Some special values include “Inf” and “-Inf” (infinite, or negative
infinite), “NaN” (not-a-number), and “NA” (not applicable, invalid). We
can indeed use special values ourselves. Here are examples of times when
they are generated:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span> <span class="co"># Inf</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="dv">0</span><span class="sc">/</span><span class="dv">0</span> <span class="co"># NaN</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">0</span>) <span class="co"># -Inf</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="cn">Inf</span><span class="sc">/-</span><span class="cn">Inf</span> <span class="co"># NaN</span></span></code></pre></div>
<p>The value ‘NA’ is not produced by any simple operation, but is
extremely common as it is often used to denote missing data. We will
learn how to deal with it in time. For now, note that most operations
with ‘NA’ in them will produce either an error or ‘NA’.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">+</span> <span class="dv">1</span> <span class="co"># produces NA</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="cn">NA</span>   <span class="co"># produces an error: &quot;Error in 1:NA : NA/NaN argument&quot;</span></span></code></pre></div>
<hr />
</div>
<div id="running-functions" class="section level2">
<h2>Running functions</h2>
<p>If we wanted to calculate the sum of all those numbers we can use a
<em>function</em> called ‘sum’.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>numbers <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="co"># Notice we use &#39;numbers&#39; as the variable name, which is far more intuitive than &#39;a&#39; or &#39;b&#39; etc.</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">sum</span>(numbers)</span></code></pre></div>
<p>Functions always have the syntax <code>FUNCTION_NAME( ... )</code>,
where the ‘…’ represents information the function needs to work.</p>
<p>Functions typically take some <em>object</em> (like a vector or a
list or a data.frame–things we will cover later) or a collection of
objects, do some processing, and <em>return</em> some other object. For
example, all these simple functions take a vector object and return a
single number. Note though, that in R, a single number is in practice
simply a vector with a length of 1.</p>
<p>Try these:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>many_numbers <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">100</span><span class="sc">:</span><span class="dv">100</span> <span class="co"># Variable naming using words separated by underscores is a convention called snake_case. The main alternative is camelCase in which capital letters indicate new words. mixedCase_isAlsoUsed. Some people like to police which should be used in what scenario but I think you should do what feels right to you.</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">sum</span>(many_numbers)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">length</span>(many_numbers)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">max</span>(many_numbers)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="fu">min</span>(many_numbers)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="fu">prod</span>(many_numbers) <span class="co"># product</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="fu">mean</span>(many_numbers)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="fu">var</span>(many_numbers) <span class="co"># variance</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="fu">sd</span>(many_numbers) <span class="co"># standard deviation</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="fu">median</span>(many_numbers)</span></code></pre></div>
<p>The <code>class()</code> function will explicitly tell you which
class(es) an object is … as a character vector.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">class</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="co"># integer</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">class</span>(<span class="fl">1.24212</span>) <span class="co"># numeric</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">class</span>(<span class="fl">1.0</span>) <span class="co"># numeric. Notice that including a decimal point is a way to enforce that values you define are numeric</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">class</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">+</span> <span class="fl">0.0</span>) <span class="co"># numeric ... Even though 0:4 is an integer vector, the `+ 0.0` forces R to convert the whole thing from an integer into a numeric vector.</span></span></code></pre></div>
<p>Other functions return vectors. For example, try:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>someNumbers <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span> <span class="co"># Camel case! Because the capital letters look like the humps on a camel, of course.</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">log</span>(someNumbers) <span class="co"># The natural logarithm. A vector the same length as the input. Notice the special values.</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">log10</span>(someNumbers) <span class="co"># The base-10 log</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="fu">sin</span>(someNumbers) <span class="co"># sine</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">acosh</span>(someNumbers) <span class="co"># hyperbolic arc-cosine. I&#39;ve never used it but good to know it exists.</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">abs</span>(someNumbers) <span class="co"># Absolute (positive) value</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="fu">sort</span>(someNumbers) <span class="co"># A vector the same length as the input.</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="fu">range</span>(someNumbers) <span class="co"># A length 2 vector containing  the maximum and minimum values</span></span></code></pre></div>
<p>Others return more obscure objects:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">summary</span>(someNumbers) <span class="co"># A &#39;table&#39;-class object</span></span></code></pre></div>
<p>… and yet others, such as <code>plot()</code>, don’t produce any
output on the console, but perform some other task. Other examples
include <code>dir.create()</code> which creates directories and
<code>read.csv()</code> which reads data from .csv files.</p>
<hr />
</div>
<div id="arguments" class="section level2">
<h2>Arguments</h2>
<p>Functions can sometimes take more than one <em>argument</em>. The
word ‘argument’ in programming strictly describes bits of information
(or objects) that are given to a function or a program:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">max</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>) <span class="co"># 10</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">range</span>(<span class="dv">1</span>,<span class="dv">58</span>,<span class="sc">-</span><span class="dv">1777</span>) <span class="co"># -1777, 58</span></span></code></pre></div>
<p>These examples just run the same talk across all inputs. A more
common case is that the different arguments contain different bits of
information about how the function should run.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">sort</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="cn">TRUE</span>) <span class="co"># 5, 4, 3, 2, 1</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">sort</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="cn">FALSE</span>) <span class="co"># 1, 2, 3, 4, 5</span></span></code></pre></div>
<p>So, the TRUE and FALSE here appear to be the answer to the question
“should I sort this list in decreasing order?”</p>
<div id="named-arguments" class="section level3">
<h3>Named arguments</h3>
<p>Since this gets very confusing as more arguments are added, R’s
arguments have names. We could have written the above command this
way:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">sort</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">decreasing=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>So, the argument giving a vector of inputs to sort is called ‘x’, and
the argument saying whether or not to sort in decreasing order is called
‘decreasing’. A single equals sign (<code>=</code>) is used for argument
assignment. It is possible to use the single equals for variable
assignment too, but you shouldn’t, and if I catch you doing it then you
have to buy me a Snickers bar. That’s how it works.</p>
</div>
<div id="default-arguments" class="section level3">
<h3>Default arguments</h3>
<p>Not every argument a function has needs to be given to it. When we
run <code>sort(10:2)</code>, it does not ask us whether we want
‘decreasing=TRUE’ or ‘decreasing=FALSE’; It just assumes
decreasing=FALSE. In this case, we say that the <em>default</em>
argument of ‘decreasing’ is FALSE. Some arguments don’t have defaults,
and these must be given or else an error message will tell you an
argument is missing. Most functions require only one input, and the
defaults of any remaining arguments are chosen to suit the most common
usage.</p>
<p>How do you know what arguments a function needs, and what its
defaults are? There are two ways, and they are the next two topics …</p>
<hr />
</div>
</div>
<div id="autocomplete-and-other-ide-shortcuts" class="section level2">
<h2>Autocomplete and other IDE shortcuts</h2>
<p>In R, you end up typing the same things a lot. The IDE (Rstudio) will
guess the ending of a lot of half-typed things, when prompted by the
<code>&lt;TAB&gt;</code> key. For example, we know the variable
‘letters’ exists. Just type …</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>le</span></code></pre></div>
<p>…, leave your cursor at the end and hit <code>&lt;TAB&gt;</code>. You
will get a scrollable, clickable, list of possible autocompletes:</p>
<p><img src="images/Rautocomplete.png" /></p>
<p>These may even bring up more help info when you highlight them. If
there is only one option, it will be filled automatically. Otherwise
select one with arrow keys or mouse and press
<code>&lt;RETURN&gt;</code> or click to insert it. Easy.</p>
<p>If you are writing a function, you can also use
<code>&lt;TAB&gt;</code> to list the arguments. To try it out type the
function name and brackets, put the cursor <em>inside the brackets</em>,
and <code>&lt;TAB&gt;</code> …</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">sort</span>()</span></code></pre></div>
<p><img src="images/Rautoargs.png" /></p>
<p>And suddenly you have a list of valid arguments with (usually)
descriptions, indicated by the purple symbol on the left.</p>
<hr />
</div>
<div id="help" class="section level2">
<h2>HELP!!!</h2>
<p>If you want even more help with a function or another object, many
come with manuals. You can search the function name here on the lower
right panel:</p>
<p><img src="images/Rsearchhelp.png" /></p>
<p>Or you can run the function name preceded by a <code>?</code>
symbol:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>?class</span></code></pre></div>
<p>… which will give you a help document containing (most importantly),
descriptions of the arguments, and examples, which are usually very
helpful.</p>
</div>
<div id="section" class="section level2">
<h2><img src="images/Rhelp.png" /></h2>
</div>
<div id="creating-vectors" class="section level2">
<h2>Creating vectors</h2>
<p>The function that creates vectors is simply called <code>c()</code>,
short for “combine” (but I think of it as “create”). For example:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;this&quot;</span>,<span class="st">&quot;character&quot;</span>,<span class="st">&quot;vector&quot;</span>,<span class="st">&quot;has&quot;</span>,<span class="st">&quot;six&quot;</span>,<span class="st">&quot;entries&quot;</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>v</span></code></pre></div>
<pre><code>## [1] &quot;this&quot;      &quot;character&quot; &quot;vector&quot;    &quot;has&quot;       &quot;six&quot;       &quot;entries&quot;</code></pre>
<p>These demonstrate the use of c to combine vectors, and how R will
convert between classes to accommodate the input classes. Try guessing
the classes of these before you run them …</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>a_integer <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>b_numeric <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.0</span>,<span class="sc">-</span><span class="fl">4.543</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>c_character <span class="ot">&lt;-</span> LETTERS</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>(a_b <span class="ot">&lt;-</span> <span class="fu">c</span>(a_integer,b_numeric)) <span class="co"># Notice the extra set of brackets around the whole command? This is a cool trick that tells R to print the result fo the assignment</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="fu">class</span>(a_b)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>(a_b_c <span class="ot">&lt;-</span> <span class="fu">c</span>(a_integer,b_numeric,c_character))</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="fu">class</span>(a_b_c)</span></code></pre></div>
<p><strong>Exercises (including some lessons about
arguments):</strong></p>
<ul>
<li>Use <code>c(...)</code> to create a vector containing the entries 1,
-4.3623, 3e6, Inf, NA, NA, and 1/3. Store it in a variable named using
the camelCase convention.</li>
<li>What would have happened if you had enclosed the first value (1) in
quotes, as in (“1”)? Would this also affect the other values in the
stored vector?</li>
<li>Try to calculate the minimum of the vector using the
<code>min()</code> function. Don’t type the whole name of your
vector–try using autocomplete (<code>&lt;TAB&gt;</code>) to help you.
What result do you get?</li>
<li>Explore the arguments to <code>min()</code> using
<code>&lt;TAB&gt;</code> as above, or the help documentation. Find an
argument that will make the function ignore ‘NA’ values when calculating
the minimum.</li>
<li>Find two more ways that use a function to give you the minimum value
in the vector (it’s ok if it tells you other stats too). Three such
functions have already come up in this tutorial.</li>
<li>Use the function <code>log()</code> to calculate the natural log of
something. Then, give it a named argument that changes it to base 2.
Finally, give it a named argument like <code>beans=...</code>, that
doesn’t exist. What happens?</li>
<li>Run your log-base-2 function again, but delete the argument names
(just leave the values, separated by commas), which will make R guess
which value belongs to which argument. Does it still work?</li>
<li>Change the order of the values. Does it still work? Does providing
argument names to one or more of the values help R to guess?</li>
</ul>
<summary>
<strong>Answers:</strong>
</summary>
<details>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>thisIsMyVector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">4.3623</span>, <span class="fl">3e6</span>, <span class="cn">Inf</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,  <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="sc">-</span><span class="fl">4.3623</span>, <span class="fl">3e6</span>, <span class="cn">Inf</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,  <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="co"># &quot;1&quot; would be interpreted as a character string, and as such a character vector would be produced, with all the other values would being converted to character strings. This is because it is simple to convert other classes to character strings, but not always the other way around. For example, the character representation of an integer like 64917 can be &quot;64917&quot;, but there is no obvious integer representation of the string &quot;beans!&quot;.</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="fu">min</span>(thisIsMyVector)</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="fu">min</span>(thisIsMyVector,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="fu">summary</span>(thisIsMyVector)</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="fu">range</span>(thisIsMyVector,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a><span class="fu">log</span>(<span class="fl">42.0</span>)</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="fu">log</span>(<span class="fl">42.0</span>, <span class="at">base=</span><span class="fl">2.0</span>)</span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a><span class="fu">log</span>(<span class="fl">42.0</span>,<span class="fl">2.0</span>) <span class="co"># Yes, that does work, it produces the same result as above.</span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">2</span>,<span class="dv">42</span>) <span class="co"># That&#39;s not what we wanted</span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a><span class="fu">log</span>(<span class="at">base=</span><span class="dv">2</span>,<span class="at">x=</span><span class="dv">42</span>) <span class="co"># That works</span></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">2</span>,<span class="at">x=</span><span class="dv">42</span>) <span class="co"># That also works</span></span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a><span class="fu">log</span>(<span class="at">base=</span><span class="dv">2</span>,<span class="dv">42</span>) <span class="co"># And that works too.</span></span></code></pre></div>
</details>
<p>As you can see, R is good at connecting the correct values to the
correct arguments. It basically follows the rule assign all named values
first, then go through the unnamed values in order and connect them to
the remaining unnamed arguments, in order.</p>
<div id="vector-creating-functions-rnorm-and-friends"
class="section level3">
<h3>Vector-creating functions: rnorm and friends</h3>
<p>In statistical analysis, you’ll often want to generate random
numbers, and we’ll use these to demonstrate more of R. Here are a few
functions to do it.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># 20 random integers between 1 and 10</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">20</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co"># 20 random real numbers between -1 and 1</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>,<span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>,<span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="co"># 20 normally-distributed numbers with mean 0 and standard deviation 0.5</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="fl">0.0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="co"># Similarly, these and others:</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a><span class="co"># rbinom(...)</span></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a><span class="co"># rpois(...)</span></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="co"># rbeta(...)</span></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="co"># rchisq(...)</span></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a><span class="co"># rweibull...()</span></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a><span class="co"># rcauchy(...)</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="indexing-vectors" class="section level2">
<h2>Indexing vectors</h2>
<p>Extracting elements of a vector can be done with the square brackets
(<code>[</code> and <code>]</code>). If we place a vector of numbers
inside the brackets, then the numbers will be taken to represent the
<em>indices</em> (singular: <em>index</em>) of the vector, i.e., 1 is
the first element, and 2 is the 2nd, etc.:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>poem <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="st">&quot;There&quot;</span>, <span class="st">&quot;are&quot;</span>, <span class="st">&quot;holes&quot;</span>, <span class="st">&quot;in&quot;</span>, <span class="st">&quot;the&quot;</span>, <span class="st">&quot;sky&quot;</span>, <span class="st">&quot;where&quot;</span>, <span class="st">&quot;the&quot;</span>, <span class="st">&quot;rain&quot;</span>, <span class="st">&quot;gets&quot;</span>, <span class="st">&quot;in&quot;</span>,</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="st">&quot;but&quot;</span>, <span class="st">&quot;the&quot;</span>, <span class="st">&quot;holes&quot;</span>, <span class="st">&quot;are&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;that&#39;s&quot;</span>, <span class="st">&quot;why&quot;</span>, <span class="st">&quot;rain&quot;</span>, <span class="st">&quot;is&quot;</span>, <span class="st">&quot;thin&quot;</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>)</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="co"># Notice I spread the command out over a few lines to make reading easier. If a line ends with a bracket still open or a command otherwise unfinished, it will assume you have a multi-line command.</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>poem[<span class="dv">3</span>] <span class="co"># &quot;holes&quot;</span></span></code></pre></div>
<pre><code>## [1] &quot;holes&quot;</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>poem[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">12</span>)]</span></code></pre></div>
<pre><code>## [1] &quot;There&quot; &quot;gets&quot;  &quot;are&quot;   &quot;but&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>poem[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>] <span class="co"># &quot;There&quot; through to &quot;in&quot; </span></span></code></pre></div>
<pre><code>##  [1] &quot;There&quot; &quot;are&quot;   &quot;holes&quot; &quot;in&quot;    &quot;the&quot;   &quot;sky&quot;   &quot;where&quot; &quot;the&quot;   &quot;rain&quot; 
## [10] &quot;gets&quot;  &quot;in&quot;</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>poem[<span class="dv">12</span><span class="sc">:</span><span class="fu">length</span>(poem)] <span class="co"># From &quot;but&quot; to the end</span></span></code></pre></div>
<pre><code>##  [1] &quot;but&quot;    &quot;the&quot;    &quot;holes&quot;  &quot;are&quot;    &quot;small&quot;  &quot;that&#39;s&quot; &quot;why&quot;    &quot;rain&quot;  
##  [9] &quot;is&quot;     &quot;thin&quot;</code></pre>
<strong>Exercises:</strong> - With the vector ‘poem’ above, use indexing
to produce a vector containing the words of the poem above, backwards. -
Research the <code>seq()</code> function. Use <code>seq()</code> in
conjunction with indexing, to produce a vector with every second word of
the poem. - Use an appropriate random vector generating function in
conjunction with indexing to shuffle the words of the poem randomly.
<details>
<summary>
<strong>See answers:</strong>
</summary>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>poem[<span class="fu">length</span>(poem)<span class="sc">:</span><span class="dv">1</span>]</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>poem[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">2</span>,<span class="at">to=</span><span class="fu">length</span>(poem),<span class="at">by=</span><span class="dv">2</span>)]</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>poem[<span class="fu">sample</span>(<span class="fu">length</span>(poem),<span class="fu">length</span>(poem))] <span class="co"># FYI, sample is a flexible function, you could also just do this: `sample(poem)`</span></span></code></pre></div>
</details>
<p>This poem is by Spike Milligan, incidentally.</p>
<div id="logical-vectors-for-indexing" class="section level3">
<h3>Logical vectors for indexing</h3>
<p>Another way to index is with logical vectors. Consider the
following:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&quot;A&quot;</span> , <span class="st">&quot;B&quot;</span>  , <span class="st">&quot;C&quot;</span> , <span class="st">&quot;D&quot;</span> )</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>v[l] <span class="co"># &quot;A&quot;, &quot;C&quot;, &quot;D&quot;</span></span></code></pre></div>
<p>As we can see, the elements of ‘v’ corresponding to the TRUE elements
of ‘l’ were selected.</p>
<p>R has shortcuts for TRUE and FALSE: You can just use T and F. Use
these cautiously as people often use these as variable names:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">c</span>(T,F) <span class="co"># Produces TRUE, FALSE</span></span></code></pre></div>
<pre><code>## [1]  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">1234</span> </span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">c</span>(T,F) <span class="co"># Produces 1234, 0 --- not what we wanted!</span></span></code></pre></div>
<pre><code>## [1] 1234    0</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">rm</span>(T) <span class="co"># This removes the variable T, so we are safe to use T and F as TRUE/FALSE again</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">c</span>(T,F) <span class="co"># TRUE, FALSE</span></span></code></pre></div>
<pre><code>## [1]  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co">#TRUE &lt;- 3 # This is not allowed, and will generate an error (try it!), so using TRUE is always safe</span></span></code></pre></div>
<strong>Exercises:</strong> - Create a vector containing the letters
C—J. Create it by using R’s pre-defined vector LETTERS, in conjunction
with indexing. Name this vector ‘L’. - Use a logical vector and indexing
to extract the letters C, E, and F. - Try selecting elements using a
logical vector of length 4. Play around if necessary. What happens? What
is the word for the process that happens? (We have seen it before and it
begins with an “R” …) - Use logical indexing and the above r-word to
extract every second letter from the vector ‘L’.
<details>
<summary>
<strong>See answer:</strong>
</summary>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>L <span class="ot">&lt;-</span> LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>L[<span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>)] <span class="co"># The indexing vector is RECYCLED, that is, it is repeated.</span></span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>L[<span class="fu">c</span>(<span class="cn">FALSE</span>,<span class="cn">TRUE</span>)]</span></code></pre></div>
</details>
<hr />
</div>
</div>
<div id="logical-operations" class="section level2">
<h2>Logical operations</h2>
<p>Some of the most fundamental operators in R involve asking yes/no
questions of vector elements. Some of the simplest are the ‘greater
than’ (<code>&gt;</code>), ‘less than’ (<code>&lt;</code>), and ‘equal
to’ (<code>==</code>) operators:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span> <span class="co"># -3 -2 -1 0 1 2 3</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>v <span class="sc">&gt;</span> <span class="dv">0</span> <span class="co"># TRUE TRUE TRUE FALSE FALSE FALSE FALSE</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>v <span class="sc">&lt;</span> <span class="dv">0</span> <span class="co"># FALSE FALSE FALSE FALSE TRUE TRUE TRUE</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>v <span class="sc">==</span> <span class="dv">0</span> <span class="co"># FALSE FALSE FALSE TRUE FALSE FALSE FALSE </span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>v <span class="sc">!=</span> <span class="dv">1</span> <span class="co"># Try it. != means &quot;is not equal to&quot;. Many programming languages associate `!` with &quot;not&quot;</span></span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>v_notEqual_zero <span class="ot">&lt;-</span> v <span class="sc">!=</span> <span class="dv">0</span> <span class="co"># We can save the results in a variable</span></span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a><span class="fu">print</span>(v_notEqual_zero) <span class="co"># TRUE TRUE TRUE FALSE TRUE TRUE TRUE</span></span></code></pre></div>
<p>Notice the equality operator is a <em>double</em> equals sign, to
distinguish it from the argument assignment operator.</p>
<div id="and-or-not" class="section level3">
<h3>AND , OR, NOT, …</h3>
<p>Often we want to combine the results of logical operations, for
example asking whether elements are less than 3, <strong>AND</strong>
greater than 1. For this we use the ‘and’ operator
(<code>&amp;</code>).</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>( v <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.2</span> ) )</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>v <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> v <span class="sc">&gt;</span> <span class="dv">1</span></span></code></pre></div>
<p>Other useful logical operators that correspond to everyday language
concepts are ‘or’ represented by a pipe symbol (<code>|</code>) and
‘not’, represented by a bang symbol (<code>!</code>). In programming we
refer to the exclamation mark as bang. If you (understandably) find that
offensively abstruse, prepare yourself to eventually encounter the
<code>?!</code> construct called an <strong>interrobang</strong>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>( v <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> )</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>v <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">|</span> v <span class="sc">==</span> <span class="dv">3</span></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>v <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span> v <span class="sc">&gt;</span> <span class="dv">2</span></span></code></pre></div>
<p>This can get very tricky. To avoid ambuiguity, brackets can be used.
For example, imagine asking which entries are either: - Greater than
three and less than six ~ <em>OR</em> ~ - Less than two and not equal to
0</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>(v <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> v <span class="sc">&lt;</span><span class="dv">6</span>) <span class="sc">|</span> (v <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="sc">!</span>(v<span class="sc">==</span><span class="dv">0</span>) ) <span class="co"># v!=0 would also work</span></span></code></pre></div>
<p>It is more common to leave out the middle step though, as in …</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>v[v<span class="sc">&gt;</span><span class="dv">0</span>]</span></code></pre></div>
<pre><code>##  [1] 1.93640563 0.03436112 1.27181747 1.82017410 1.89428594 1.01034044
##  [7] 0.43166367 0.72663645 0.21668908 0.35509322 1.35982538 0.03159864
## [13] 1.59815244 0.20473654 0.41761661 0.87320634 0.38378735 0.82576933
## [19] 0.12150214 1.74984111 1.18857802 0.26631923 0.52541606 0.32156784
## [25] 0.37979905 0.01870846 1.00639692 0.26366786 0.42068165 0.46456179
## [31] 0.25969251 0.80582758 0.71221703 0.19008603 1.43668171 0.72594790
## [37] 1.50054887 1.36580010 0.02968984 0.75385167 0.60315595 1.34792766
## [43] 0.36713938 0.28376715 0.21576572 0.37128780 0.85316464</code></pre>
<p>And one last thing, the very common function <code>which()</code>
tells you <strong>which</strong> entries of a logical vector are TRUE.
So <code>which(c(TRUE,FALSE,TRUE))</code> will return the vector ( 1 , 3
), because 1 and 3 are the indices of the TRUE entries. Based on this,
explain to yourself why the two commands below produce the same
result:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>v[v<span class="sc">&gt;</span><span class="dv">5</span>] <span class="co"># a logical vector</span></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>v[<span class="fu">which</span>(v<span class="sc">&gt;</span><span class="dv">5</span>)] <span class="co"># the same logical vector ... why?</span></span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a><span class="co"># Look, I know you are thinking &quot;actually ... `which` seems pointless&quot;. And yes, which() is often pointless. But it is extremely common, and so you need to know it to read other peoples&#39; code.</span></span></code></pre></div>
<p><strong>Exercises:</strong></p>
<ul>
<li>Create a vector ‘v’ containing 20 numbers drawn from a normal
distribution with a mean of zero.</li>
<li>Create logical vector telling you which values of ‘v’ are greater
than one standard deviation above the mean, and use it to produce a
vector containing only those values of ‘v’.</li>
<li>Using one command only, make a vector of values from ‘v’ that are
within standard deviation of the mean, either above <em>or</em>
below.</li>
<li>Modify the above command to return the <em>range</em> of the values
from ‘v’ that are within standard deviation of the mean.</li>
</ul>
<details>
<summary>
<strong>See answer:</strong>
</summary>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>( v <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>) ) <span class="co"># Remember, surrounding the assignment command in brackets forces it to print</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>( vPositive <span class="ot">&lt;-</span> v <span class="sc">&gt;</span> <span class="dv">0</span> )</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>v[vPositive]</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>vGt1SD <span class="ot">&lt;-</span> v <span class="sc">&gt;</span> ( <span class="fu">mean</span>(v) <span class="sc">+</span> <span class="fu">sd</span>(v) )</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>v[vGt1SD]</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>v[ (v <span class="sc">&gt;</span> ( <span class="fu">mean</span>(v) <span class="sc">-</span> <span class="fu">sd</span>(v) )) <span class="sc">&amp;</span> (v <span class="sc">&lt;</span> ( <span class="fu">mean</span>(v) <span class="sc">+</span> <span class="fu">sd</span>(v) )) ]</span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>v[<span class="fu">abs</span>(v<span class="sc">-</span><span class="fu">mean</span>(v)) <span class="sc">&lt;</span> <span class="fu">sd</span>(v)] <span class="co"># Or alternatively ...</span></span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a><span class="fu">range</span>( v[<span class="fu">abs</span>(v<span class="sc">-</span><span class="fu">mean</span>(v)) <span class="sc">&lt;</span> <span class="fu">sd</span>(v)] )</span></code></pre></div>
</details>
<p>Last thing! If you use <code>sum()</code> on a logical vector, it
will count the ’TRUE’s. Very useful. In general, if you use logical
vectors in functions that usually expect numbers, then they will treat
TRUE and FALSE as 1 and 0. So <code>sum(c(TRUE,FALSE,TRUE))</code> will
give the answer 2.</p>
<p><strong>Exercises:</strong></p>
<ul>
<li>Create a one-line command that generates 10,000 random numbers with
a mean of 0 and a standard deviation of 10, and tells you how many are
positive.</li>
</ul>
<details>
<summary>
<strong>See answer:</strong>
</summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">sum</span>( <span class="fu">rnorm</span>(<span class="fl">1e4</span>,<span class="dv">0</span>,<span class="dv">10</span>) <span class="sc">&gt;</span> <span class="dv">0</span> )</span></code></pre></div>
</details>
</div>
<div id="indexing-with-assignment" class="section level3">
<h3>Indexing with assignment</h3>
<p>Indexing doesn’t just let you extract parts of vectors—it also lets
you assign values to them. Consider:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> LETTERS[<span class="dv">4</span><span class="sc">:</span><span class="dv">9</span>]</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="fu">print</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot; &quot;I&quot;</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>a[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;POITION 2 IS HERE&quot;</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="fu">print</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;D&quot;                 &quot;POITION 2 IS HERE&quot; &quot;F&quot;                
## [4] &quot;G&quot;                 &quot;H&quot;                 &quot;I&quot;</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>a[<span class="fu">c</span>(T,F,T,F,F,F)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;POSITION 1 IS HERE&quot;</span>,<span class="st">&quot;POSITION 3 IS HERE&quot;</span>) <span class="co"># We selected two spots (two TRUE elements, and assigning them two new values)</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a><span class="fu">print</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;POSITION 1 IS HERE&quot; &quot;POITION 2 IS HERE&quot;  &quot;POSITION 3 IS HERE&quot;
## [4] &quot;G&quot;                  &quot;H&quot;                  &quot;I&quot;</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>a[<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="st">&quot;XXX&quot;</span> <span class="co"># We are selecting three items, and assigning them one new value---all three will be set to this one value</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a><span class="fu">print</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;POSITION 1 IS HERE&quot; &quot;POITION 2 IS HERE&quot;  &quot;POSITION 3 IS HERE&quot;
## [4] &quot;G&quot;                  &quot;H&quot;                  &quot;I&quot;                 
## [7] &quot;XXX&quot;                &quot;XXX&quot;                &quot;XXX&quot;</code></pre>
</div>
<div
id="towards-real-data-analysis-indexing-and-calculations-using-multiple-data-vectors"
class="section level3">
<h3>Towards real data analysis: Indexing and calculations using multiple
data vectors</h3>
<p>Imagine you have two vectors describing a dataset in which 20 <a
href="https://en.wikipedia.org/wiki/Santalum_acuminatum">quandong
trees</a> were grown in each of two fields, one of which is treated with
fertiliser. At the end of the growing season, the quandong fruits each
tree were counted. To describe this dataset, we could use two vectors.
First, we could make one vector that gives each sample a unique ID, and
a second vector to tell us which group–fertiliser or control–each sample
is in, and a third to tell us the number of fruits for each.</p>
<p>I will make some ‘toy’ data (fake data, to use while developing
analysis pipelines) below. We VERY often use toy datasets in
bioinformatics–it means we can get on with writing analyses before the
data arrive, and they often help to spot possible experimental problems
and bugs in our code. I have no idea whether these ‘data’ are realistic
but it doesn’t matter.</p>
<p>As we make and analyse toy data I will use some functions you have
not seen before. They are very common. Use experimentation, the help
docs, and web searches to work out what they do.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="co"># This is a toy dataset to practise on, so we are just using some random data. Make sure you understand how I&#39;ve generated it by breaking these commands down into pieces and using the help function where needed ...</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>sampleIds <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Sample&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="co"># paste() combines strings together</span></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Fertiliser&quot;</span>,<span class="st">&quot;Control&quot;</span>), <span class="at">each=</span><span class="dv">10</span> ) <span class="co"># rep repeats vectors or items from vectors multiple times</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>nFruits   <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">2400</span>,<span class="dv">50</span>) , <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">2300</span>,<span class="dv">50</span>) )</span></code></pre></div>
<p>Now, use what you know to answer these. There are several ways to do
each (so your answer may differ from mine). If you’ve done some R before
and you feel like loading a package–don’t! This is about using
fundamentals.</p>
<p>Feel free to peek at the solutions–we combine several ideas here.</p>
<p><strong>Exercises:</strong></p>
<ul>
<li>What is the mean fruit count for trees grown with fertiliser?</li>
<li>What is the average change in fruit yield you expect to see when
fertilising a crop of quandongs, based on these data? (express as a
percentage)</li>
<li>Which fruit(s) (sample IDs) in the control group have the highest
number of fruits? You will probably need more than one command to do
this.</li>
<li>Research the <code>order()</code> function. Use it to produce a list
of sample names in the order of highest fruit count to lowest.</li>
</ul>
<details>
<summary>
<strong>See answer:</strong>
</summary>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">mean</span>(nFruits[treatment<span class="sc">==</span><span class="st">&quot;Fertiliser&quot;</span>])</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a><span class="fu">mean</span>(nFruits[treatment<span class="sc">==</span><span class="st">&quot;Fertiliser&quot;</span>]) <span class="sc">/</span> <span class="fu">mean</span>(nFruits[treatment<span class="sc">==</span><span class="st">&quot;Control&quot;</span>]) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>ctrlSamps   <span class="ot">&lt;-</span> sampleIds[treatment<span class="sc">==</span><span class="st">&quot;Control&quot;</span>]</span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>ctrlNfruits <span class="ot">&lt;-</span>  nFruits[treatment<span class="sc">==</span><span class="st">&quot;Control&quot;</span>]</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>ctrlSamps[ctrlNfruits<span class="sc">==</span><span class="fu">max</span>(ctrlNfruits)]</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>sampleIds[<span class="fu">order</span>(nFruits,<span class="at">decreasing =</span> <span class="cn">TRUE</span>)]</span></code></pre></div>
</details>
<p>Ok that’s the end of this section! The next section will learn some
slightly more advanced ideas that are used to manipulate and analyse
real data.</p>
</div>
</div>
</div>
<div id="part-2-basic-data-analysis" class="section level1">
<h1>Part 2: Basic data analysis</h1>
<hr />
<div id="data-frames" class="section level2">
<h2>Data frames</h2>
<p>In the last example we used three vectors to store three pieces of
information about a collection of samples. If we were to add in
formation about the plant heights to the dataset, we would have to
create another vector–and every new piece of information about each
sample would require yet another.</p>
<p>There are some things you have to pay attention to storing and
manipulating data in this way: All the vectors have to keep the same
length, and remain in same order. This would be very tricky to manage as
soon as more than a two or three vectors are involved. Thankfully, we
have a way of ‘tying’ vectors toegether for just this purpose.</p>
<p>The structure is called a data frame, and we traditionally view them
with each vector of data stacked vertically, just like the columns of a
spreadsheet. Let’s make one now …</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>  sampleIds,</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>  treatment,</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>  nFruits</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>)</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a><span class="fu">print</span>(df)</span></code></pre></div>
<pre><code>##    sampleIds  treatment  nFruits
## 1   Sample 1 Fertiliser 2371.195
## 2   Sample 2 Fertiliser 2374.052
## 3   Sample 3 Fertiliser 2375.687
## 4   Sample 4 Fertiliser 2340.822
## 5   Sample 5 Fertiliser 2414.569
## 6   Sample 6 Fertiliser 2444.425
## 7   Sample 7 Fertiliser 2429.481
## 8   Sample 8 Fertiliser 2431.257
## 9   Sample 9 Fertiliser 2300.528
## 10 Sample 10 Fertiliser 2366.587
## 11 Sample 11    Control 2208.949
## 12 Sample 12    Control 2289.073
## 13 Sample 13    Control 2299.140
## 14 Sample 14    Control 2277.046
## 15 Sample 15    Control 2231.009
## 16 Sample 16    Control 2338.286
## 17 Sample 17    Control 2279.673
## 18 Sample 18    Control 2317.196
## 19 Sample 19    Control 2246.447
## 20 Sample 20    Control 2342.736</code></pre>
<p>Much neater! We can use indexing on data frames to get and set
variables. With data frames we use two indexes (for rows and columns),
separated by a comma. So the to see or set the third entry in the first
column we do this:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>df[<span class="dv">3</span>,<span class="dv">1</span>] <span class="co"># &quot;Sample 3&quot;</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>df[<span class="dv">3</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Sample 21&quot;</span></span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>df[<span class="dv">3</span>,<span class="dv">1</span>] <span class="co"># &quot;Sample 21&quot;</span></span></code></pre></div>
<p>We can also use ranges and logical vectors, as we have seen before.
These can be used to assign values—and this uses recycling rules! That
is, the range being written to must be a multiple of the range being
written:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="co"># Select rows 1 to 8 of columns 2 and 3</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>df[<span class="fu">c</span>(T,F),<span class="fu">c</span>(T,T,F)] <span class="co"># Select every second row of columns 1 and 2. Note the use of recycling here!</span></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Control&quot;</span>) <span class="co"># Replaces the first two entries of the treatment column, overwrites them both with &quot;Control&quot;.</span></span></code></pre></div>
<p>And we can select whole rows or columns by leaving the field
blank:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>df[<span class="dv">4</span>,] <span class="co"># Fourth row only</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>df[,<span class="dv">3</span>] <span class="co"># Third column only</span></span></code></pre></div>
<p>We can also select columns by name using character vectors:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>df[,<span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>,<span class="st">&quot;sampleIds&quot;</span>)][<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,] <span class="co"># First five rows of two selected columns. Note the use of indexing twice--the second one applies to the results first. You will use this a lot!</span></span></code></pre></div>
<p>The functions <code>nrow()</code> and <code>ncol()</code> give you
the row and column counts of data frames, which is useful:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>df[<span class="fu">nrow</span>(df)<span class="sc">:</span><span class="dv">1</span>,] <span class="co"># Reversing the order of the rows</span></span></code></pre></div>
<p>For convenience, columns can be extracted with the dollar
(<code>$</code>) operator. It also lets you autocomplete with
<code>\&lt;TAB\&gt;</code>, remember that?</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>df<span class="sc">$</span>sampleIds</span></code></pre></div>
<p>We now have three ways to access columns, by number, name, and by
name using the dollar sign. All three can be used to create new columns.
Simply assign values to a column that does not exist yet!</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>df[,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(df)) <span class="co"># A new fourth column of &#39;NA&#39;s will appear. It will be automatically named &#39;V4&#39;</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>df[,<span class="st">&quot;newCol2&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;These&quot;</span>,<span class="st">&quot;will&quot;</span>,<span class="st">&quot;recycle---&quot;</span>,<span class="st">&quot;now!&quot;</span>)</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>df<span class="sc">$</span>newCol3 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df)<span class="sc">:</span><span class="dv">1</span></span></code></pre></div>
<p>Now with these tools, you have the power to simplify calculations,
such as the maximum of the fruit counts in the control group:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">max</span>(df[df<span class="sc">$</span>treatment<span class="sc">==</span><span class="st">&quot;Control&quot;</span>,<span class="st">&quot;nFruits&quot;</span>])</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a><span class="fu">max</span>(df[df<span class="sc">$</span>treatment<span class="sc">==</span><span class="st">&quot;Control&quot;</span>,]<span class="sc">$</span>nFruits) <span class="co"># Identical but using dollar sign operator after the indexing ...</span></span></code></pre></div>
<p>Many calculations will involve adding new columns based on the
current columns. For instance, what if we want to give fruit counts as a
percentage of the maximum?</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>df<span class="sc">$</span>nFruitsPercentMax <span class="ot">&lt;-</span> df<span class="sc">$</span>nFruits <span class="sc">/</span> <span class="fu">max</span>(df<span class="sc">$</span>nFruits) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<p><strong>Exercises:</strong></p>
<p>Using the data frame ‘df’ as created above using:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>  sampleIds,</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>  treatment,</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>  nFruits</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li>Replace the first four entries in the ‘treatment’ column with the
value “Heat”.</li>
<li>Write a one-line command to print the number of rows remaining in
the “Fertiliser” treatment group.</li>
<li>Create and store a new data frame called ‘df_ctrl’ containing data
only from control samples.</li>
<li>Set any samples of this data frame that have fruit counts less than
1 standard deviation below the mean to ‘NA’</li>
<li>Add a new column named “percentVsCtrl” to ‘df’ that records that
sample’s fruit count as a percentage of the average fruit count in the
control samples (excluding those ‘NA’ samples from the last step—you
will have to account for this in your command(s) somehow).</li>
<li>Try out the functions <code>colnames()</code> and
<code>rownames()</code> on your data frame ‘df’—they extract the column-
and row names. The row names will be empty by default. Use a combination
of the <code>rownames()</code> function, the assignment operator
(<code>&lt;-</code>), and the <code>paste()</code> function to set the
row names to “Row_1”, “Row_2”, … , “Row_20”.</li>
</ul>
<details>
<summary>
<strong>See answer:</strong>
</summary>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="st">&quot;treatment&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Heat&quot;</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a><span class="fu">sum</span>(df<span class="sc">$</span>treatment<span class="sc">==</span><span class="st">&quot;Fertiliser&quot;</span>)</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>df_ctrl <span class="ot">&lt;-</span> df[df<span class="sc">$</span>treatment<span class="sc">==</span><span class="st">&quot;Control&quot;</span>,]</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>df_ctrl[df_ctrl<span class="sc">$</span>nFruits <span class="sc">&lt;</span> ( <span class="fu">mean</span>(df_ctrl<span class="sc">$</span>nFruits) <span class="sc">-</span> <span class="fu">sd</span>(df_ctrl<span class="sc">$</span>nFruits) ),]<span class="sc">$</span>nFruits <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a>df<span class="sc">$</span>percentVsCtrl <span class="ot">&lt;-</span> ( df<span class="sc">$</span>nFruits <span class="sc">/</span> <span class="fu">mean</span>(df_ctrl<span class="sc">$</span>nFruits,<span class="at">na.rm =</span> <span class="cn">TRUE</span>) ) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a></span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a><span class="fu">colnames</span>(df)</span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a><span class="fu">rownames</span>(df)</span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Row&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df),<span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span></code></pre></div>
</details>
<div id="creating-data-frames" class="section level4">
<h4>Creating data frames</h4>
<p>It is possible to create data frames from nothing, by giving column
names as argument names, and the corresponding values as arguments:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>  <span class="at">someIntegers      =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>  <span class="at">someLetters       =</span> letters[<span class="dv">26</span><span class="sc">:</span><span class="dv">24</span>],</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>  <span class="at">someRandomNumbers =</span> <span class="fu">runif</span>(<span class="dv">3</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##   someIntegers someLetters someRandomNumbers
## 1            1           z        -0.3789356
## 2            2           y        -0.6968778
## 3            3           x        -0.5512314</code></pre>
</div>
<div id="combining-data-frames-with-rbind" class="section level4">
<h4>Combining data frames with rbind</h4>
<p>If two data frames have identical columns, then the rows can be
joined together using <code>rbind()</code>:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>iris1 <span class="ot">&lt;-</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,] <span class="co"># R always loads several datasets to experiment on. &#39;iris&#39; is a famous data set indeed--you can read about it by running `?iris`</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> iris[<span class="fu">nrow</span>(iris)<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>,] <span class="co"># This selects the last two rows --- can you work out why it works?</span></span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>iris1</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>iris2</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 149          6.2         3.4          5.4         2.3 virginica
## 150          5.9         3.0          5.1         1.8 virginica</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">rbind</span>(iris1,iris2)</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 1            5.1         3.5          1.4         0.2    setosa
## 2            4.9         3.0          1.4         0.2    setosa
## 149          6.2         3.4          5.4         2.3 virginica
## 150          5.9         3.0          5.1         1.8 virginica</code></pre>
<p>The corresponding function <code>cbind()</code> for columns also
exists—but should almost never be used as there is almost always a
better way. Both these functions can enable inefficient code, because
ech time they are used they create an entirely new copy of both data
frames, consuming time and memory. They should be used rarely and
carefully.</p>
<p>The next time we see data frames, everything will get far easier,
thanks to the package data.table. But now you understand the
fundamentals about how they work you have the power to take R much
further.</p>
<hr />
</div>
</div>
<div id="str" class="section level2">
<h2><code>str()</code></h2>
<p>The function <code>str()</code> is the most useful general purpose
tool for describing what is R objects contain. You can try it on
basically any object. In the case of data frames, it describes the
contents of each of the columns, the dimensions of the data frame, etc
….</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">str</span>(iris)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<hr />
</div>
<div id="readingwriting-data" class="section level2">
<h2>Reading/writing data</h2>
<div id="as-data-frames-csv-and-other-excel-compatible-formats"
class="section level4">
<h4>… as data frames: CSV and other Excel-compatible formats</h4>
<p>Data often needs to be transported between different programs.
Bioinformatic data often takes the form of tables, and one of the most
simple text-based table formats that exists is called CSV:
Comma-Separated Values. It follow these simple rules:</p>
<ul>
<li>A new row starts ever time there is a new line.</li>
<li>A new column starts every time there is a comma.</li>
<li>The first line is normally the column names.</li>
<li>Each row must have the same number of columns (commas).</li>
<li>If a value between commas is in quote marks (“…”) it is interpreted
as a single character string, even if it contains a comma.</li>
</ul>
<p>Here’s an example using Formula 1 drivers:</p>
<pre><code>team,driver,wins,born
McLaren,&quot;Piastri, Norris&quot;,1,2001
Mercedes,&quot;Russel, George&quot;,2,1998
Ferrari,&quot;Leclerc, Charles&quot;,6,1997</code></pre>
<p><strong>Exercises:</strong></p>
<ul>
<li>Copy this text into a blank file and save it as “drivers.csv”. You
can use this option in Rstudio to make blank text files:</li>
</ul>
<p><img src="images/RtextFile.PNG" /></p>
<ul>
<li>Read the file into R as a data frame, using a command like
<code>read.csv("drivers.csv")</code>. Give it a name like ‘F1’.</li>
<li>Add a column to (any name and values are fine).</li>
<li>Write ‘F1’ with the new name to a file using the function
<code>write.csv()</code>, and check you can open the file in Excel. If
you are on the cluster you may have to use <a
href="docs/tutorial_sftp.html">SFTP</a> or some other method to access
it from the desktop.</li>
<li>Add the argument “row.names=FALSE” and try again. Confirm that the
row names are not present as an extra column in the output.</li>
</ul>
<p>Other common formats include TSV (Tab-Separated Values) and SSV
(Space …) which are identical but with different column separation
characters. Common bioinformatic formats like GFF, BED, and VCF all
approximately fit the TSV format.</p>
<hr />
</div>
</div>
<div id="plotting-with-base" class="section level2">
<h2>Plotting (with base)</h2>
<p>In R we make plots by adding items into the plot, step-by-step.</p>
<p>Let’s use the ‘iris’ dataset to start off (have a look at it yourself
and note the different columns), and explore the relationship between
petal dimensions of iris flowers. The first step …</p>
<ul>
<li>Creates the axes, and</li>
<li>Adds the first plot item (e.g. lines or points)</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>  <span class="at">x =</span> iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>  <span class="at">y =</span> iris<span class="sc">$</span>Petal.Width,</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&#39;p&#39;</span></span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="tutorial_R_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<p>The “type = ‘p’” argument directs R to make points (a scatterplot),
but it is the default anyway. Lines don’t make much sense here but if
you want to try that, run the command with “type = ‘l’”.</p>
<p>Let’s add some layers. By calling another plot function
<code>abline()</code>, we can add lines to the plot. Let’s add some
lines to indicate the minimum and maximum range of petal lengths in the
species <em>setosa</em>. We will use some arguments to manipulate the
colours etc.</p>
<ul>
<li><code>abline()</code> will draw a vertical line if given the
argument ‘v=…’</li>
<li>We can set the line’s colours using the argument ‘col=…’. You can
use some names like “red”, “darkblue”, etc., but for total freedom I
like to use RGB colours, which you can look up at (e.g.) <a
href="https://rgbcolorpicker.com/"
class="uri">https://rgbcolorpicker.com/</a></li>
<li>‘lwd=…’ sets the line width. 1 is default</li>
<li>‘lty=…’ sets the line type, such as dashed lines with varying length
dashes</li>
</ul>
<p><img src="images/Rcolpick.PNG" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>  <span class="at">x =</span> iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>  <span class="at">y =</span> iris<span class="sc">$</span>Petal.Width,</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&#39;p&#39;</span></span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>)</span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a><span class="fu">abline</span>(</span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a>  <span class="at">v   =</span> <span class="fu">range</span>(iris[iris<span class="sc">$</span>Species<span class="sc">==</span><span class="st">&quot;setosa&quot;</span>,]<span class="sc">$</span>Petal.Length), <span class="co"># `range()` produces two numbers, so we will get one line for each</span></span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#2a2fdb73&quot;</span>,<span class="st">&quot;#c73a3a73&quot;</span>), <span class="co"># Notice we are giving two colours--one colour per line</span></span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">5</span>, <span class="co"># Now we are giving just one value. This will recycle--so it will be applied to all lines!</span></span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a>  <span class="at">lty =</span> <span class="dv">3</span></span>
<span id="cb97-12"><a href="#cb97-12" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="tutorial_R_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>You can look up parameters like line types here: <a
href="https://r-graph-gallery.com/6-graph-parameters-reminder.html"
class="uri">https://r-graph-gallery.com/6-graph-parameters-reminder.html</a></p>
<p><strong>Exercises:</strong></p>
<ul>
<li>Add a column to ‘iris’ called “colour”. Make it contain the value
“red” when the species is <em>setosa</em>, “blue” for
<em>versicolor</em>, and “black” for <em>virginica</em>. This may take a
few lines of code (although, you can research a function like
<code>switch()</code> to get it done in one …)</li>
<li>Create a scatterplot of sepal length (x) vs sepal width (y), with:
<ul>
<li>Colours corresponding to species, using the column you added. The
relevant argument will look something like
<code>col=iris$colour</code></li>
<li>Use the “pch=…” argument to change the point type to a small filled
dot (e.g. … number 20).</li>
<li>Use the “cex=…” argument to change the size of the points. Set them
all to 2. ‘cex’ means ‘coefficient of expansion’, I think …</li>
<li>Use the “xlab=…” argument to set the label on the x-axis to “Sepal
Width”.</li>
</ul></li>
<li>Add horizontal (“h==…”) lines to mark the range of sepal widths in
species <em>versicolor</em>.
<ul>
<li>The line widths should be 4 for the smaller end of the range, and 8
for the larger end.</li>
<li>Both should be semi-transparent pastel green. Use an RGB colour to
set them. You will have to use the “alpha” setting on the website to get
the semi-transparency.</li>
</ul></li>
</ul>
<details>
<summary>
<strong>See answer:</strong>
</summary>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>iris[iris<span class="sc">$</span>Species<span class="sc">==</span><span class="st">&quot;setosa&quot;</span>,<span class="st">&quot;colour&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>iris[iris<span class="sc">$</span>Species<span class="sc">==</span><span class="st">&quot;versicolor&quot;</span>,<span class="st">&quot;colour&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>iris[iris<span class="sc">$</span>Species<span class="sc">==</span><span class="st">&quot;virginica&quot;</span>,<span class="st">&quot;colour&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>  <span class="at">x   =</span> iris<span class="sc">$</span>Sepal.Length,</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>  <span class="at">y   =</span> iris<span class="sc">$</span>Sepal.Width,</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>  <span class="at">col =</span> iris<span class="sc">$</span>colour,</span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;Sepal Width&quot;</span>,</span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a>  <span class="at">cex =</span> <span class="dv">2</span>,</span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">20</span></span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a>)</span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a></span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a><span class="fu">abline</span>(</span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a>  <span class="at">h   =</span> <span class="fu">range</span>(iris[iris<span class="sc">$</span>Species<span class="sc">==</span><span class="st">&quot;versicolor&quot;</span>,]<span class="sc">$</span>Sepal.Width),</span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">8</span>),</span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#4a8a43a0&quot;</span></span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div id="layer-layer-layer" class="section level4">
<h4>Layer, layer, layer</h4>
<p>These basic concepts you have can be extended to produce almost any
figure you can imagine. In almost all cases, you will start by
manipulating your data to create columns that are helpful for plotting
(as we did with iris$colour before), then create some sort of basic
plot, then add layers.</p>
<p>The basic plot types that base R (i.e. R without packages added)
allows include:</p>
<ul>
<li>Scatterplots (<code>plot(...,type='p')</code>)</li>
<li>Line plots (<code>plot(...,type='l')</code>)</li>
<li><code>histogram()</code></li>
<li><code>boxplot()</code></li>
</ul>
<p>And the functions you will use to layer things on will include …</p>
<ul>
<li><code>points()</code></li>
<li><code>lines()</code></li>
<li><code>legend()</code> – Draw a legend!</li>
<li><code>rect()</code> – Rectangles, anywhere, any size, colour
etc.</li>
<li><code>polygon()</code> – Even more flexibility! Draw whatever shape
you can describe using x/y coordinates.</li>
<li><code>text()</code> – Anywhere, any font, size, colour, angle
etc.</li>
</ul>
<p>You can also produce multiple plots per page, of any size, even
overlapping, and have full control over the axes, text, etc. This
tutorial won’t cover all the things that can be done, just be aware:</p>
<ul>
<li>Let your imagination guide you—not the tools you can find! Sketch
the plot you want on a whiteboard, then set about finding what tools can
do it.</li>
<li>MANY packages exist to help make really interesting and intricate
plots. The package <code>ggplot2</code> is an excellent example. Just
remember—to become completely expressive in R, you will need to go back
to basics (and you may need to remember some trigonometry).</li>
</ul>
<p>For example, let’s say you want to represent wind directions and
magnitudes in an intuitive plot like the below. There’s no package to do
it—but it takes about 6 R commands to make from basics. Ask me if you
want to see the code but the take-home point is, if you can imagine it,
there’s a way to do it …</p>
<p><img src="tutorial_R_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="lists" class="section level2">
<h2>Lists</h2>
<p>Remember how a data frame neatly ties a group of equal-length vectors
together into a sort of table? Well what if you want to tie a collection
of data frames together? Or a collection of vectors? Or a mixture?</p>
<p>Lists are the data structures that allow this, and the following
demonstrates that …</p>
<ul>
<li>A list can be created using very similar syntax to creating a data
frame.</li>
<li>List members can be named or unnamed, and members is accessed using
double square brackets (<code>[[...]]</code>) or the dollar sign
operator.</li>
<li>The difference between accessing list items with double and single
square bracket operators.</li>
</ul>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="co"># Creating a list</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  <span class="at">a_vector =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>  <span class="at">another_vector =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">NA</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>),</span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>  <span class="at">a_data_frame =</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="fu">c</span>(<span class="st">&quot;Species&quot;</span>,<span class="st">&quot;Sepal.Width&quot;</span>)],</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>  <span class="at">a_list =</span> <span class="fu">list</span>( <span class="at">a =</span> <span class="st">&quot;A&quot;</span> , <span class="at">b =</span> <span class="st">&quot;B&quot;</span> ),</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>  <span class="st">&quot;an unnamed member&quot;</span></span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>)</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a></span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a><span class="co"># Explore contents</span></span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a><span class="fu">str</span>(l)</span></code></pre></div>
<pre><code>## List of 5
##  $ a_vector      : int [1:4] 1 2 3 4
##  $ another_vector: logi [1:4] TRUE NA FALSE TRUE
##  $ a_data_frame  :&#39;data.frame&#39;:  3 obs. of  2 variables:
##   ..$ Species    : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1
##   ..$ Sepal.Width: num [1:3] 3.5 3 3.2
##  $ a_list        :List of 2
##   ..$ a: chr &quot;A&quot;
##   ..$ b: chr &quot;B&quot;
##  $               : chr &quot;an unnamed member&quot;</code></pre>
<div class="sourceCode" id="cb101"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="co"># Access (and edit) first item a few ways</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>l[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>l<span class="sc">$</span>a_vector</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>l[[<span class="dv">1</span>]][<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>l<span class="sc">$</span>a_vector</span></code></pre></div>
<pre><code>## [1]  1 NA  3  4</code></pre>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="co"># A demonstation -- the double square brakets extract the actual items in the list...</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>l[[<span class="dv">3</span>]]</span></code></pre></div>
<pre><code>##   Species Sepal.Width
## 1  setosa         3.5
## 2  setosa         3.0
## 3  setosa         3.2</code></pre>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">class</span>(l[[<span class="dv">3</span>]])</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="co"># The single square brackets extract subsets of the list, as a list. The example below produces a list of length 1.</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a><span class="fu">class</span>(l[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<hr />
</div>
<div id="writing-your-own-functions" class="section level2">
<h2>Writing your own functions</h2>
<p>A key skill is writing your own functions. The way to create a
function follows this syntax:</p>
<pre><code>FUNCTION_NAME &lt;- function( argument1_name , argument2_name = &lt;argument2_default&gt; ){
  # Function body
  return(&lt;return value&gt;)
}</code></pre>
<p>Let’s create a function to transform a vector of numbers to express
them in standard deviations from the mean, that is, as Z-scores. We name
the function ‘zScore’. It will need to take a vector, so let’s start it
off with just one argument called ‘x’.</p>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>zScore <span class="ot">&lt;-</span> <span class="cf">function</span>( x ){</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>  <span class="co"># Function body</span></span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>  <span class="co"># return(&lt;return value&gt;)</span></span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>}</span></code></pre></div>
<p>Ok, as for the function body, that’s where we perform the relevant
calculations. In this case, we need to follow the formula for Z-scores
<span class="math inline">\(Z_x\)</span> of the vector <span
class="math inline">\(x\)</span>: <span class="math display">\[
Z_x = \frac{x - \bar{x}}{\sigma^2_x}
\]</span> Where <span class="math inline">\(\bar{x}\)</span> is the mean
of all the values in x and <span
class="math inline">\(\sigma^2_x\)</span> is the standard deviation of
x.</p>
<p>And the return value is of course the result of these calculations,
the Z-scores.</p>
<div class="sourceCode" id="cb115"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a>sdFromMean <span class="ot">&lt;-</span> <span class="cf">function</span>( x ){</span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a>  <span class="co"># Function body</span></span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb115-5"><a href="#cb115-5" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> ( x <span class="sc">-</span> mu ) <span class="sc">/</span> sigma</span>
<span id="cb115-6"><a href="#cb115-6" tabindex="-1"></a>  <span class="fu">return</span>(Z)</span>
<span id="cb115-7"><a href="#cb115-7" tabindex="-1"></a>}</span>
<span id="cb115-8"><a href="#cb115-8" tabindex="-1"></a></span>
<span id="cb115-9"><a href="#cb115-9" tabindex="-1"></a><span class="co"># Running the function</span></span>
<span id="cb115-10"><a href="#cb115-10" tabindex="-1"></a><span class="fu">sdFromMean</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb115-11"><a href="#cb115-11" tabindex="-1"></a><span class="fu">sdFromMean</span>(<span class="fu">runif</span>(<span class="dv">10</span>))</span></code></pre></div>
<p>Ok, what about when there are ‘NA’ values in the vectors though?</p>
<div class="sourceCode" id="cb116"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="fu">sdFromMean</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)) <span class="co"># Error</span></span></code></pre></div>
<p>We could fix this in the function by adding <code>na.rm=TRUE</code>
to both the <code>mean()</code> and <code>sd()</code> functions. But
what if the user doesn’t <em>want</em> the function to ignore ‘NA’
values? Perhaps we can let the user choose? We can do this by adding
another argument, for example called “removeNAs=…”, and <em>passing</em>
its value on to the “na.rm=…” arguments of <code>mean()</code> and
<code>sd()</code> inside the function body …</p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a>sdFromMean <span class="ot">&lt;-</span> <span class="cf">function</span>( x , removeNAs ){</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a>  <span class="co"># Function body</span></span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(x,<span class="at">na.rm=</span>removeNAs)</span>
<span id="cb117-4"><a href="#cb117-4" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">sd</span>(x,<span class="at">na.rm=</span>removeNAs)</span>
<span id="cb117-5"><a href="#cb117-5" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> ( x <span class="sc">-</span> mu ) <span class="sc">/</span> sigma</span>
<span id="cb117-6"><a href="#cb117-6" tabindex="-1"></a>  <span class="fu">return</span>(Z)</span>
<span id="cb117-7"><a href="#cb117-7" tabindex="-1"></a>}</span>
<span id="cb117-8"><a href="#cb117-8" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" tabindex="-1"></a><span class="co"># Running the function</span></span>
<span id="cb117-10"><a href="#cb117-10" tabindex="-1"></a><span class="fu">sdFromMean</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">removeNAs =</span> <span class="cn">TRUE</span>) <span class="co"># Works</span></span>
<span id="cb117-11"><a href="#cb117-11" tabindex="-1"></a><span class="fu">sdFromMean</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)) <span class="co"># ... fails --- missing argument!</span></span></code></pre></div>
<p>Better, but it’s a bit annoying to specify “removeNAs=…” every time
we use the function. Maybe we can put in a default value of ‘FALSE’,
that way we only need the user to specify it when they want it to be
TRUE:</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>sdFromMean <span class="ot">&lt;-</span> <span class="cf">function</span>( x , <span class="at">removeNAs=</span><span class="cn">FALSE</span> ){</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>  <span class="co"># Function body</span></span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(x,<span class="at">na.rm=</span>removeNAs)</span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">sd</span>(x,<span class="at">na.rm=</span>removeNAs)</span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> ( x <span class="sc">-</span> mu ) <span class="sc">/</span> sigma</span>
<span id="cb118-6"><a href="#cb118-6" tabindex="-1"></a>  <span class="fu">return</span>(Z)</span>
<span id="cb118-7"><a href="#cb118-7" tabindex="-1"></a>}</span>
<span id="cb118-8"><a href="#cb118-8" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" tabindex="-1"></a><span class="co"># Running the function</span></span>
<span id="cb118-10"><a href="#cb118-10" tabindex="-1"></a><span class="fu">sdFromMean</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">removeNAs =</span> <span class="cn">TRUE</span>) <span class="co"># Works</span></span>
<span id="cb118-11"><a href="#cb118-11" tabindex="-1"></a><span class="fu">sdFromMean</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)) <span class="co"># Works!</span></span></code></pre></div>
<p><strong>Exercises:</strong></p>
<ul>
<li>Create a function called ‘topRows’ that takes a data frame (like
‘iris’) and an integer (call it, say, ‘n’), and returns the top n rows
of the data frame
<ul>
<li>The user should be able to specify how many rows in the returned
data table</li>
<li>The default number of rows returned should be 1</li>
</ul></li>
</ul>
<details>
<summary>
<strong>See answer:</strong>
</summary>
<div class="sourceCode" id="cb119"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a>topRows <span class="ot">&lt;-</span> <span class="cf">function</span>(df,<span class="at">n=</span><span class="dv">1</span>){</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>  out <span class="ot">&lt;-</span> df[<span class="dv">1</span><span class="sc">:</span>n,]</span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>}</span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a><span class="co"># Even more concise:</span></span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>topRows <span class="ot">&lt;-</span> <span class="cf">function</span>(df,<span class="at">n=</span><span class="dv">1</span>){</span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>  <span class="fu">return</span> (df[<span class="dv">1</span><span class="sc">:</span>n,])</span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>}</span>
<span id="cb119-10"><a href="#cb119-10" tabindex="-1"></a></span>
<span id="cb119-11"><a href="#cb119-11" tabindex="-1"></a><span class="co">#Even even more concise. If the function finishes without hitting a return statement, it returns the last line. Avoid this except in extremely simple functions.</span></span>
<span id="cb119-12"><a href="#cb119-12" tabindex="-1"></a>topRows <span class="ot">&lt;-</span> <span class="cf">function</span>(df,<span class="at">n=</span><span class="dv">1</span>){</span>
<span id="cb119-13"><a href="#cb119-13" tabindex="-1"></a>  df[<span class="dv">1</span><span class="sc">:</span>n,]</span>
<span id="cb119-14"><a href="#cb119-14" tabindex="-1"></a>}</span>
<span id="cb119-15"><a href="#cb119-15" tabindex="-1"></a></span>
<span id="cb119-16"><a href="#cb119-16" tabindex="-1"></a><span class="co"># Try it!</span></span>
<span id="cb119-17"><a href="#cb119-17" tabindex="-1"></a><span class="fu">topRows</span>(iris,<span class="at">n=</span><span class="dv">3</span>)</span></code></pre></div>
</details>
<hr />
</div>
<div id="loops-with-lapply" class="section level2">
<h2>Loops! with <code>lapply()</code></h2>
<blockquote>
<p>This is the hardest part of learning basic R.</p>
</blockquote>
<p>… but <a
href="https://en.wikipedia.org/wiki/Phrases_from_The_Hitchhiker&#39;s_Guide_to_the_Galaxy#Don&#39;t_Panic"><strong>DON’T
PANIC</strong></a>! Just have a strong coffee and follow the
instructions carefully. Once you get it, it’s all much more relaxing
from there.</p>
<p>A theme across most programming languages is the need to perform a
similar task many times on slightly different inputs. For example, if
the task is creating a genetic map, then we might need to complete it
once for chromosome 1, again for chromosome 2, and again for chromosomes
3, 4, etc.</p>
<p>We can automate these cases using <em>apply</em>-type functions.</p>
<p>Create a toy data frame describing a collection of gene expression
(“tpm”—transcript per million) values using this code:</p>
<div class="sourceCode" id="cb120"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="co"># Don&#39;t try to understand this, we will learn it later.</span></span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a>  <span class="at">geneID =</span> <span class="fu">paste0</span>(<span class="st">&quot;GeneID:&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>),</span>
<span id="cb120-4"><a href="#cb120-4" tabindex="-1"></a>  <span class="at">tissue =</span> <span class="fu">c</span>(<span class="st">&quot;Stem&quot;</span>,<span class="st">&quot;Leaf&quot;</span>,<span class="st">&quot;Root&quot;</span>,<span class="st">&quot;Influorescence&quot;</span>),</span>
<span id="cb120-5"><a href="#cb120-5" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> F</span>
<span id="cb120-6"><a href="#cb120-6" tabindex="-1"></a>)</span>
<span id="cb120-7"><a href="#cb120-7" tabindex="-1"></a>e<span class="sc">$</span>tpm <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">6</span><span class="sc">*</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">**</span> <span class="dv">3</span></span></code></pre></div>
<p>Now, create a function that will take expression data like this, and
return the tissue of the highest expressing gene:</p>
<div class="sourceCode" id="cb121"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>highestExpGeneID <span class="ot">&lt;-</span> <span class="cf">function</span>(edf){</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>  edf[edf<span class="sc">$</span>tpm<span class="sc">==</span><span class="fu">max</span>(edf<span class="sc">$</span>tpm),]<span class="sc">$</span>tissue</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>}</span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a><span class="co"># Test it ...</span></span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a><span class="fu">highestExpGeneID</span>(e)</span></code></pre></div>
<p>Now, use this function, along with data frame indexing, to find the
highest expressing tissue of gene with ID “GeneID:3”</p>
<div class="sourceCode" id="cb122"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="fu">highestExpGeneID</span>(e[e<span class="sc">$</span>geneID<span class="sc">==</span><span class="st">&quot;GeneID:3&quot;</span>,])</span></code></pre></div>
<p>But what if you want a readout for <em>every</em> gene?</p>
<p>Well the starting point might be to get a list of all the gene IDs,
so for that we could use the function unique:</p>
<div class="sourceCode" id="cb123"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">unique</span>(e<span class="sc">$</span>geneID) <span class="co"># &quot;GeneID:1&quot; &quot;GeneID:2&quot; &quot;GeneID:3&quot; &quot;GeneID:4&quot; &quot;GeneID:5&quot; &quot;GeneID:6&quot;</span></span></code></pre></div>
<p>But how do we make the function <code>highestExpGeneID()</code> run
once for every one of these?</p>
<p>Here is where we use <code>lapply()</code>, which stands for “list
apply”; “list” because the thing we will get back is a list (with one
entry for each run of the function), and “apply” because it is going to
<em>apply</em> the function several times. The syntax is like this:</p>
<pre><code>result_list &lt;- lapply( X=&lt;list of items&gt; , FUN=&lt;function that will be applied once for each list item&gt; )</code></pre>
<p>Now, ‘FUN’ is a function, that describes what we want to do with each
item in ‘X’. What do we want to do for each item (geneID)?</p>
<ul>
<li>Extract the rows of ‘e’ that contain data for that geneID, and
…</li>
<li>… run <code>highestExpGeneID()</code> on those rows.</li>
</ul>
<p>So we will have a function that calls a function. We don’t need to
name the function–we just need to know that it will receive the geneIDs
in ‘X’ one at a time, <em>as its first argument, no matter what that
argument is named</em>. I call it ‘g’, in the example below.</p>
<details>
<summary>
<strong>If you’re confused, study these examples (if not, go
on):</strong>
</summary>
<div class="sourceCode" id="cb125"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="fu">lapply</span>( <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> , <span class="cf">function</span>(x) { x <span class="sc">+</span> <span class="dv">100</span> } )</span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a><span class="fu">lapply</span>( letters , <span class="cf">function</span>(letter) { <span class="fu">paste0</span>(<span class="st">&quot;:&quot;</span>,letter,<span class="st">&quot;:&quot;</span>) } )</span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a>animals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Fish&quot;</span>,<span class="st">&quot;Frog&quot;</span>,<span class="st">&quot;Pangolin&quot;</span>,<span class="st">&quot;Wallaby&quot;</span>,<span class="st">&quot;Turtle&quot;</span>) , <span class="at">mammal =</span> <span class="fu">c</span>(F,F,T,T,F) )</span>
<span id="cb125-6"><a href="#cb125-6" tabindex="-1"></a><span class="co"># Which animals are mammals? Which are not?</span></span>
<span id="cb125-7"><a href="#cb125-7" tabindex="-1"></a><span class="fu">lapply</span>( <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>) , <span class="cf">function</span>(tf) {</span>
<span id="cb125-8"><a href="#cb125-8" tabindex="-1"></a>  animals[animals<span class="sc">$</span>mammal<span class="sc">==</span>tf,]<span class="sc">$</span>name</span>
<span id="cb125-9"><a href="#cb125-9" tabindex="-1"></a>} )</span></code></pre></div>
</details>
<p>Ok, so here’s our command to find the highest expressing tissue for
each gene:</p>
<div class="sourceCode" id="cb126"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>highestExpressionEachGene <span class="ot">&lt;-</span> <span class="fu">lapply</span>( <span class="fu">unique</span>(e<span class="sc">$</span>geneID) , <span class="cf">function</span>(g){</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>  <span class="fu">highestExpGeneID</span>(e[e<span class="sc">$</span>geneID<span class="sc">==</span>g,])</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>} )</span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>highestExpressionEachGene</span></code></pre></div>
<div id="sapply" class="section level4">
<h4>sapply</h4>
<p>It is natural to wonder whether a list is really the most useful
thing to get back here. We gave it a vector of gene IDs. Could we get a
vector back? Well, yes. But this will only work well then the thing you
get back is a single-item vector—what if it returned a data frame?</p>
<p>The answer is to replace <code>lapply()</code> with
<code>sapply()</code> (“simplified apply”). Or …</p>
<div class="sourceCode" id="cb127"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="fu">unlist</span>(highestExpressionEachGene)</span></code></pre></div>
<p>With this in hand, you could even create a nice little data frame of
results:</p>
<div class="sourceCode" id="cb128"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>maxExp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>  <span class="at">geneID       =</span> <span class="fu">unique</span>(e<span class="sc">$</span>geneID),</span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>  <span class="at">maxExpTissue =</span> <span class="fu">sapply</span>( <span class="fu">unique</span>(e<span class="sc">$</span>geneID) , <span class="cf">function</span>(g){ <span class="fu">highestExpGeneID</span>(e[e<span class="sc">$</span>geneID<span class="sc">==</span>g,]) } )</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>)</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>maxExp</span></code></pre></div>
<p>Great! Your turn.</p>
<p><strong>Exercises:</strong></p>
<p>Use the expression data as generated by:</p>
<div class="sourceCode" id="cb129"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a>  <span class="at">geneID =</span> <span class="fu">paste0</span>(<span class="st">&quot;GeneID:&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>),</span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a>  <span class="at">tissue =</span> <span class="fu">c</span>(<span class="st">&quot;Stem&quot;</span>,<span class="st">&quot;Leaf&quot;</span>,<span class="st">&quot;Root&quot;</span>,<span class="st">&quot;Influorescence&quot;</span>),</span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> F</span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a>)</span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a>e<span class="sc">$</span>tpm <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">6</span><span class="sc">*</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">**</span> <span class="dv">3</span></span></code></pre></div>
<ul>
<li>Using lapply/sapply and other tricks from this section, create a
data frame that contains a row each for the “Stem” and “Leaf” tissues ,
with one column called ‘tissue’ naming the tissue, and another called
‘medianExp’ which contains the median tpm expression value across genes
for that tissue.</li>
</ul>
<details>
<summary>
<strong>See clues (and answer):</strong>
</summary>
<div class="sourceCode" id="cb130"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="co">#I will build this up in several steps</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a><span class="co"># the syntax is `lapply(X,FUN)`</span></span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a><span class="co"># We need to apply to two tissues so we list them in X. For FUN, let&#39;s just create a simple function that returns exactly what is given ...</span></span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a><span class="fu">lapply</span>( <span class="fu">c</span>(<span class="st">&quot;Leaf&quot;</span>,<span class="st">&quot;Stem&quot;</span>) , <span class="cf">function</span>(t){ t } )</span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a><span class="co"># So, t is set to &quot;Leaf&quot; first, then &quot;Stem&quot;</span></span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a><span class="co"># We need to be selecting rows of e there e$tissue is &quot;Leaf&quot; and then &quot;Stem&quot;, so let&#39;s try returning versions of e with just those selected ...</span></span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a><span class="fu">lapply</span>( <span class="fu">c</span>(<span class="st">&quot;Leaf&quot;</span>,<span class="st">&quot;Stem&quot;</span>) , <span class="cf">function</span>(t) { e[e<span class="sc">$</span>tissue<span class="sc">==</span>t,] } )</span>
<span id="cb130-9"><a href="#cb130-9" tabindex="-1"></a><span class="co"># Ok, and but what we want to work with is the tpm, so let&#39;s use what we know about data frames to extract just that column ...</span></span>
<span id="cb130-10"><a href="#cb130-10" tabindex="-1"></a><span class="fu">lapply</span>( <span class="fu">c</span>(<span class="st">&quot;Leaf&quot;</span>,<span class="st">&quot;Stem&quot;</span>) , <span class="cf">function</span>(t) { e[e<span class="sc">$</span>tissue<span class="sc">==</span>t,]<span class="sc">$</span>tpm } )</span>
<span id="cb130-11"><a href="#cb130-11" tabindex="-1"></a><span class="co"># Good, and what do we want with tpm? The median, so we use the function median() to calcualte it on those results ...</span></span>
<span id="cb130-12"><a href="#cb130-12" tabindex="-1"></a><span class="fu">lapply</span>( <span class="fu">c</span>(<span class="st">&quot;Leaf&quot;</span>,<span class="st">&quot;Stem&quot;</span>) , <span class="cf">function</span>(t) { <span class="fu">median</span>( e[e<span class="sc">$</span>tissue<span class="sc">==</span>t,]<span class="sc">$</span>tpm ) } )</span>
<span id="cb130-13"><a href="#cb130-13" tabindex="-1"></a><span class="co"># So close! We just prefer this as a vector not a list, so we use `sapply()`</span></span>
<span id="cb130-14"><a href="#cb130-14" tabindex="-1"></a><span class="fu">sapply</span>( <span class="fu">c</span>(<span class="st">&quot;Leaf&quot;</span>,<span class="st">&quot;Stem&quot;</span>) , <span class="cf">function</span>(t) { <span class="fu">median</span>( e[e<span class="sc">$</span>tissue<span class="sc">==</span>t,]<span class="sc">$</span>tpm ) } )</span>
<span id="cb130-15"><a href="#cb130-15" tabindex="-1"></a></span>
<span id="cb130-16"><a href="#cb130-16" tabindex="-1"></a></span>
<span id="cb130-17"><a href="#cb130-17" tabindex="-1"></a><span class="co"># That&#39;s great -- we have the tissues we need ( c(&quot;Leaf&quot;,&quot;Stem&quot;) ) and their median expression values ( the long sapply command above ).</span></span>
<span id="cb130-18"><a href="#cb130-18" tabindex="-1"></a><span class="co"># To make a data frame, we just use the regular syntax for making one ...</span></span>
<span id="cb130-19"><a href="#cb130-19" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb130-20"><a href="#cb130-20" tabindex="-1"></a>  <span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb130-21"><a href="#cb130-21" tabindex="-1"></a>  <span class="at">b =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)</span>
<span id="cb130-22"><a href="#cb130-22" tabindex="-1"></a>)</span>
<span id="cb130-23"><a href="#cb130-23" tabindex="-1"></a><span class="co"># ... except we enter the tissue and median tpm values using the calculations we worked out:</span></span>
<span id="cb130-24"><a href="#cb130-24" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb130-25"><a href="#cb130-25" tabindex="-1"></a>  <span class="at">tissue    =</span> <span class="fu">c</span>(<span class="st">&quot;Leaf&quot;</span>,<span class="st">&quot;Stem&quot;</span>),</span>
<span id="cb130-26"><a href="#cb130-26" tabindex="-1"></a>  <span class="at">medianExp =</span> <span class="fu">sapply</span>( <span class="fu">c</span>(<span class="st">&quot;Leaf&quot;</span>,<span class="st">&quot;Stem&quot;</span>) , <span class="cf">function</span>(t) { <span class="fu">median</span>( e[e<span class="sc">$</span>tissue<span class="sc">==</span>t,]<span class="sc">$</span>tpm ) } )</span>
<span id="cb130-27"><a href="#cb130-27" tabindex="-1"></a>)</span>
<span id="cb130-28"><a href="#cb130-28" tabindex="-1"></a></span>
<span id="cb130-29"><a href="#cb130-29" tabindex="-1"></a><span class="co"># That&#39;s the answer!</span></span></code></pre></div>
</details>
<blockquote>
<p>Well done!!!</p>
</blockquote>
<p>You can be very proud that you have managed to do many tasks using
the very fundamentals of R, that many people never even learn. From here
on we will let ourselves use various packages and other things that make
things much easier–but your understanding of them will be deeper than if
we started with them immediately.</p>
</div>
</div>
</div>
<div id="part-3-beyond-fundamentals" class="section level1">
<h1>Part 3: Beyond fundamentals</h1>
<hr />
<div id="matrices" class="section level2">
<h2>Matrices</h2>
<p>We saw lists and data frames. Matrices are another object, use to
store grids, most often of numbers. The advantages of matrices are that
certain operations become very, very fast. They work much like vectors
and lists and things you are already good at. We will just demonstrate
the basics here for you to run so you are not surprised when you run
into them:</p>
<div class="sourceCode" id="cb131"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="co"># Define a matrix</span></span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a>( m1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>,<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span><span class="dv">4</span>) )</span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" tabindex="-1"></a><span class="co"># Index using row/column ranges or blank; nrow/ncol:</span></span>
<span id="cb131-5"><a href="#cb131-5" tabindex="-1"></a>m1[<span class="dv">3</span><span class="sc">:</span><span class="fu">nrow</span>(m1),] <span class="co"># Can also be assigned with `&lt;-`</span></span>
<span id="cb131-6"><a href="#cb131-6" tabindex="-1"></a></span>
<span id="cb131-7"><a href="#cb131-7" tabindex="-1"></a><span class="co"># Perform element-wise operations</span></span>
<span id="cb131-8"><a href="#cb131-8" tabindex="-1"></a>m1 <span class="sc">+</span> m1</span>
<span id="cb131-9"><a href="#cb131-9" tabindex="-1"></a>m1[<span class="dv">1</span>,] <span class="sc">-</span> m1[,<span class="dv">3</span>]</span>
<span id="cb131-10"><a href="#cb131-10" tabindex="-1"></a>m1 <span class="sc">*</span> <span class="fl">3.2</span></span>
<span id="cb131-11"><a href="#cb131-11" tabindex="-1"></a></span>
<span id="cb131-12"><a href="#cb131-12" tabindex="-1"></a><span class="co"># Logical operations and assignment</span></span>
<span id="cb131-13"><a href="#cb131-13" tabindex="-1"></a>m1[m1<span class="sc">&lt;</span><span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="sc">-</span>m1[m1<span class="sc">&lt;</span><span class="dv">6</span>] <span class="co"># make negative</span></span>
<span id="cb131-14"><a href="#cb131-14" tabindex="-1"></a></span>
<span id="cb131-15"><a href="#cb131-15" tabindex="-1"></a><span class="co"># Define another, with one column</span></span>
<span id="cb131-16"><a href="#cb131-16" tabindex="-1"></a>( m2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">100</span>,<span class="dv">4</span>),<span class="at">nrow=</span><span class="dv">4</span>) )</span>
<span id="cb131-17"><a href="#cb131-17" tabindex="-1"></a></span>
<span id="cb131-18"><a href="#cb131-18" tabindex="-1"></a><span class="co"># Perform matrix multiplication</span></span>
<span id="cb131-19"><a href="#cb131-19" tabindex="-1"></a>m1 <span class="sc">%*%</span> m2</span>
<span id="cb131-20"><a href="#cb131-20" tabindex="-1"></a></span>
<span id="cb131-21"><a href="#cb131-21" tabindex="-1"></a><span class="co"># Matrix-specific functions, e.g. ...</span></span>
<span id="cb131-22"><a href="#cb131-22" tabindex="-1"></a><span class="fu">colMeans</span>(m1)</span>
<span id="cb131-23"><a href="#cb131-23" tabindex="-1"></a><span class="fu">rowSums</span>(m1)</span>
<span id="cb131-24"><a href="#cb131-24" tabindex="-1"></a></span>
<span id="cb131-25"><a href="#cb131-25" tabindex="-1"></a><span class="co"># Transpose</span></span>
<span id="cb131-26"><a href="#cb131-26" tabindex="-1"></a><span class="fu">t</span>(m2)</span>
<span id="cb131-27"><a href="#cb131-27" tabindex="-1"></a></span>
<span id="cb131-28"><a href="#cb131-28" tabindex="-1"></a><span class="co"># The `apply()` function is designed for matrices.</span></span>
<span id="cb131-29"><a href="#cb131-29" tabindex="-1"></a><span class="fu">apply</span>( m1 , <span class="dv">2</span> , <span class="cf">function</span>(col) {col<span class="sc">/</span><span class="fu">mean</span>(col)} ) <span class="co"># The `2` refers to the function operating on columns; 1=rows, 2=columns. See ?apply</span></span></code></pre></div>
<hr />
</div>
<div id="if-and-if-else-type-conditional-statements"
class="section level2">
<h2><code>if</code> and <code>if-else</code>-type conditional
statements</h2>
<p>Another programming fundamental is the if statement. Use it when code
needs to make a decision that can be worded like:</p>
<p><strong>… If X is true, do this thing …</strong></p>
<p>This is expressed as follows:</p>
<pre><code>if( CONDITION ){
  # Code to run if true
}</code></pre>
<p>So a simple example would be:</p>
<div class="sourceCode" id="cb133"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a><span class="cf">if</span>(a <span class="sc">&gt;</span> <span class="dv">3</span>){</span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;a is more than 3!&quot;</span>)</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>}</span></code></pre></div>
<p>Other statements might come in the form:</p>
<p><strong>… If X is true, do thing A. Otherwise, do thing
B</strong></p>
<p>Corresponding to …</p>
<div class="sourceCode" id="cb134"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a><span class="cf">if</span>(a <span class="sc">&gt;</span> <span class="dv">3</span>){</span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;a is more than 3! Doing thing A&quot;</span>)</span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb134-5"><a href="#cb134-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;a is not more than 3! Doing thing B&quot;</span>)</span>
<span id="cb134-6"><a href="#cb134-6" tabindex="-1"></a>}</span></code></pre></div>
<p>And finally:</p>
<p><strong>… If X is true, do thing A. Otherwise if Y is true, do thing
B. Otherwise, do thing C.</strong></p>
<p>Corresponding to …</p>
<div class="sourceCode" id="cb135"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a><span class="cf">if</span>(a <span class="sc">&gt;</span> <span class="dv">3</span>){</span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;a is more than 3! Doing thing A&quot;</span>)</span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (a<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;a is 1! Doing thing B&quot;</span>)</span>
<span id="cb135-6"><a href="#cb135-6" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb135-7"><a href="#cb135-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;None of those things were true! Doing thing C&quot;</span>)</span>
<span id="cb135-8"><a href="#cb135-8" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Exercises:</strong></p>
<p>Genotypes of biallelic variants are sometimes expressed as the
numbers 0—2, where 0 means homozygous for the reference genotype, 1
means heterozygote, and 2 means homozygous for the alternative
allele.</p>
<ul>
<li>Create a random vector called ‘GTs’, of 15 0s, 1s, and 2s.</li>
<li>Use sapply to convert the vector into the character strings “Ref”
for 0, “Het” for 1, and “Alt” for 2.
<ul>
<li>Do this using if/else statements inside the function you give to
sapply.</li>
<li>HINT: Consider the following function, and note the multiple return
statements:
<code>isBig &lt;- function(x) { if(x&gt;9999999){return(TRUE)} else {return(FALSE)} }</code></li>
</ul></li>
<li>BONUS: Can you achieve the task another, completely different,
way?</li>
</ul>
<details>
<summary>
<strong>See answer:</strong>
</summary>
<div class="sourceCode" id="cb136"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>GTs <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">15</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a><span class="fu">sapply</span>( GTs , <span class="cf">function</span>(gt){</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>  <span class="cf">if</span>(gt<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;Ref&quot;</span>)</span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(gt<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;Het&quot;</span>)</span>
<span id="cb136-7"><a href="#cb136-7" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(gt<span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb136-8"><a href="#cb136-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;Alt&quot;</span>)</span>
<span id="cb136-9"><a href="#cb136-9" tabindex="-1"></a>  }</span>
<span id="cb136-10"><a href="#cb136-10" tabindex="-1"></a>})</span>
<span id="cb136-11"><a href="#cb136-11" tabindex="-1"></a></span>
<span id="cb136-12"><a href="#cb136-12" tabindex="-1"></a></span>
<span id="cb136-13"><a href="#cb136-13" tabindex="-1"></a><span class="co"># Examples of other ways:</span></span>
<span id="cb136-14"><a href="#cb136-14" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="fu">length</span>(GTs))</span>
<span id="cb136-15"><a href="#cb136-15" tabindex="-1"></a>out[GTs<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Ref&quot;</span></span>
<span id="cb136-16"><a href="#cb136-16" tabindex="-1"></a>out[GTs<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Het&quot;</span></span>
<span id="cb136-17"><a href="#cb136-17" tabindex="-1"></a>out[GTs<span class="sc">==</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Alt&quot;</span></span>
<span id="cb136-18"><a href="#cb136-18" tabindex="-1"></a>out</span>
<span id="cb136-19"><a href="#cb136-19" tabindex="-1"></a></span>
<span id="cb136-20"><a href="#cb136-20" tabindex="-1"></a><span class="co"># ~ or ~</span></span>
<span id="cb136-21"><a href="#cb136-21" tabindex="-1"></a></span>
<span id="cb136-22"><a href="#cb136-22" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Ref&quot;</span>,<span class="st">&quot;Het&quot;</span>,<span class="st">&quot;Alt&quot;</span>)[GTs<span class="sc">+</span><span class="dv">1</span>]</span></code></pre></div>
</details>
<hr />
</div>
<div id="packages-and-magrittr" class="section level2">
<h2>Packages (and Magrittr)</h2>
<p>Packages are available on the internet. “Official” R packages are on
a site called <a href="https://cran.r-project.org/">CRAN</a>, and are
expected to meet some kind of standards for reliability and
compatibility.</p>
<p>To get a package from CRAN, it’s as simple as:</p>
<div class="sourceCode" id="cb137"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;magrittr&quot;</span>) <span class="co"># Magrittr is the package name</span></span></code></pre></div>
<p>If everything goes well with the install, we can access functions
from the package with the package name followed by two colons
(<code>::</code>) and then the function name …</p>
<div class="sourceCode" id="cb138"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>magrittr<span class="sc">::</span><span class="fu">raise_to_power</span>(<span class="dv">4</span>,<span class="dv">2</span>)</span></code></pre></div>
<p>Or more commonly, you’ll just want to be able to access all a
package’s functions all the time without the trouble of writing its name
all the time, in which case you can run <code>require()</code> to load
all the functions:</p>
<div class="sourceCode" id="cb139"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a><span class="fu">require</span>(magrittr) <span class="co"># You may also come across `library()` which does the same but re-loads the package each time, no matter if the package is already loaded or not.</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="fu">raise_to_power</span>(<span class="dv">4</span>,<span class="dv">2</span>)</span></code></pre></div>
<p>You have to be careful with this, because often packages use the same
function names, in which case it can get ambiguous which one is
intended.</p>
<div id="magrittr" class="section level4">
<h4>Magrittr</h4>
<p>What does the magrittr package do? Well, it enables a special type of
syntax, similar to pipes in linux. Consider:</p>
<div class="sourceCode" id="cb140"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">range</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">+</span><span class="dv">4</span>))<span class="sc">**</span><span class="dv">3</span></span></code></pre></div>
<p>I.e., we take the object 1:10, <em>then</em> add 4, <em>then</em>
take the range, <em>then</em> take the mean, <em>then</em> raise to the
power of 3. All very simple, but the command isn’t easy to write or
follow. The magrittr pipe, <code>%&gt;%</code> basically places the
object to the left of it as the first argument to the function on the
right of it. As a result, it can be used like the word “then” …</p>
<div class="sourceCode" id="cb141"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">range</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">+</span><span class="dv">4</span>))<span class="sc">**</span><span class="dv">3</span></span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">%&gt;%</span> <span class="fu">add</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span> range <span class="sc">%&gt;%</span> mean <span class="sc">%&gt;%</span> <span class="fu">raise_to_power</span>(<span class="dv">3</span>)</span></code></pre></div>
<p>And yep it is magrittr that introduces these helper functions like
<code>add()</code> and <code>raise_to_power()</code> to help it all
along.</p>
</div>
<div id="data.table" class="section level4">
<h4>data.table</h4>
<p>The most important package in all bioinformatics is data.table.</p>
<div class="sourceCode" id="cb142"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a><span class="fu">require</span>(data.table)</span></code></pre></div>
<p>There is a full data.table tutorial you should do, but to give you a
taste of how much easier data.table and magrittr can make things,
consider how you would calculate the mean petal length from the iris
dataset normally:</p>
<div class="sourceCode" id="cb143"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="fu">mean</span>(iris[iris<span class="sc">$</span>Species<span class="sc">==</span><span class="st">&quot;setosa&quot;</span>,<span class="st">&quot;Petal.Length&quot;</span>])</span></code></pre></div>
<p>Ok, so magrittr could help avoid that awkward <code>mean()</code>
function needing to be wrapped around a big inner command:</p>
<div class="sourceCode" id="cb144"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a>iris[iris<span class="sc">$</span>Species<span class="sc">==</span><span class="st">&quot;setosa&quot;</span>,<span class="st">&quot;Petal.Length&quot;</span>] <span class="sc">%&gt;%</span> mean</span></code></pre></div>
<p>Still, why do we have to write iris twice? Wouldn’t it be great if
inside the indexing fields, we could just access the columns by name
like normal vectors? We can, if we convert it to a data.table, which
allows this usage:</p>
<div class="sourceCode" id="cb145"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a>iris <span class="sc">%&lt;&gt;%</span> as.data.table <span class="co"># A magrittr trick, see ?magrittr::`%&lt;&gt;%`</span></span></code></pre></div>
<p>Then we could write:</p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a>iris[Species<span class="sc">==</span><span class="st">&quot;setosa&quot;</span>,Petal.Length] <span class="sc">%&gt;%</span> mean</span></code></pre></div>
<p>But since we are allowed to use raw column names as vectors inside
the indexing … couldn’t we also just run functions on them there?</p>
<div class="sourceCode" id="cb147"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a>iris[Species<span class="sc">==</span><span class="st">&quot;setosa&quot;</span>,<span class="fu">mean</span>(Petal.Length)]</span></code></pre></div>
<p>Easy! Head over to the <a href="docs/tutorial_data_table.html">full
data.table tutorial</a> once you’re done here …</p>
<hr />
</div>
</div>
<div id="plotting-with-ggplot2" class="section level2">
<h2>Plotting (with ggplot2)</h2>
<p>This is a brilliant plotting package. I won’t teach it here, but
don’t be afraid to learn it, there are plenty of good resources
online.</p>
<p>An example:</p>
<div class="sourceCode" id="cb148"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a><span class="fu">ggplot</span>( iris , <span class="fu">aes</span>( <span class="at">x =</span> Petal.Width , <span class="at">y =</span> Petal.Length ,  <span class="at">group =</span> <span class="fu">as.factor</span>(Species) ) ) <span class="sc">+</span></span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Species<span class="sc">~</span>.,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="tutorial_R_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<p>As you can see, ggplot is excellent for quickly showing your data in
ways that help you see the general picture and decide how to move on.
<strong>However</strong>, the moment you find yourself using all kinds
of complicated tricks to make ggplot produce the thing you imagine in
your head, I suggest move back to base plot—it is trickier, but
infinitely more flexible.</p>
<hr />
</div>
</div>
<div id="you-did-it" class="section level1">
<h1>You did it!</h1>
<p>The key now is to practise, and the key to practice is to have a task
to work on. So next time you’re thinking about some data and you
mentally ask “I wonder if I could …” then jump on R, find or simulate
some data, and try to make your idea work.</p>
<p>You 100% should make data.table the next thing you learn in depth,
but if you want some little extra tricks up your sleeve that you can
learn quickly with a web search, then <strong>the R debugger</strong>
and <strong>benchmarking</strong> are very useful.</p>
<p>But for now …</p>
<blockquote>
<p>CONGRATULATIONS!</p>
</blockquote>
<p>You deserve cake, or wine, or wine and cake. Go and do something you
like that isn’t R.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
